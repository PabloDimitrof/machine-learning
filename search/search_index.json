{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#projeto-de-machine-learning-projeto-1","title":"Projeto de Machine Learning \u2014 Projeto 1","text":"<p>Bem-vindo! Este espa\u00e7o re\u00fane o Projeto 1 de Machine Learning desenvolvido no formato do Prof. Humberto Sandmann, com foco em organiza\u00e7\u00e3o clara, reprodutibilidade e compara\u00e7\u00e3o de algoritmos.</p>"},{"location":"#objetivo-geral","title":"Objetivo Geral","text":"<p>Investigar, treinar e avaliar diferentes algoritmos de Machine Learning em um conjunto de dados tabular, passando por todas as etapas do fluxo padr\u00e3o: 1. Explora\u00e7\u00e3o dos Dados (EDA) 2. Pr\u00e9-processamento 3. Divis\u00e3o Treino/Teste 4. Treinamento de Modelos    - \u00c1rvore de Decis\u00e3o    - K-Nearest Neighbors (KNN) \u2014 vers\u00e3o manual e <code>scikit-learn</code>    - K-Means (clustering)    - Random Forest 5. Avalia\u00e7\u00e3o do Modelo (acur\u00e1cia, precis\u00e3o, recall, F1, matriz de confus\u00e3o, ROC-AUC) 6. Relat\u00f3rio Final com achados e pr\u00f3ximos passos</p>"},{"location":"#base-de-dados","title":"Base de Dados","text":"<ul> <li>Dataset principal: Premier League Stats</li> <li>Alvo supervisionado (quando aplic\u00e1vel): <code>quality_high</code> (derivado de <code>points \u2265 90</code>).  </li> <li>Observa\u00e7\u00e3o: Em tarefas n\u00e3o supervisionadas (K-Means), o r\u00f3tulo n\u00e3o \u00e9 usado no treino; m\u00e9tricas s\u00e3o obtidas via mapeamento posterior (voto majorit\u00e1rio).</li> </ul>"},{"location":"#metodologia-visao-resumida","title":"Metodologia (vis\u00e3o resumida)","text":"<ul> <li>EDA: descri\u00e7\u00e3o das vari\u00e1veis, distribui\u00e7\u00e3o, frequ\u00eancias e poss\u00edveis outliers (gr\u00e1ficos espec\u00edficos por tipo de dado).  </li> <li>Pr\u00e9-processamento: limpeza de colunas, convers\u00f5es de tipo, label encoding/one-hot para categ\u00f3ricas, padroniza\u00e7\u00e3o quando necess\u00e1rio e evitar vazamento (ex.: <code>points</code> n\u00e3o entra como feature quando gera o alvo).  </li> <li>Split: 70% treino / 30% teste, estratificado pelo alvo.  </li> <li>Modelagem: </li> <li>\u00c1rvore de Decis\u00e3o: baseline interpret\u00e1vel.  </li> <li>KNN: implementa\u00e7\u00e3o manual para did\u00e1tica + vers\u00e3o <code>scikit-learn</code> com PCA (visualiza\u00e7\u00e3o da fronteira).  </li> <li>K-Means: k=3 (explorat\u00f3rio), PCA 2D e avalia\u00e7\u00e3o via mapeamento cluster\u2192classe.  </li> <li>Random Forest: ensemble para reduzir vari\u00e2ncia e melhorar generaliza\u00e7\u00e3o.</li> </ul>"},{"location":"#como-reproduzir","title":"Como Reproduzir","text":"<ol> <li>Garanta um ambiente com Python 3.10+ e instale:    ```bash    pip install pandas numpy scikit-learn matplotlib</li> </ol>"},{"location":"arvore-decisao/main/","title":"\u00c1rvore de Decis\u00e3o","text":""},{"location":"arvore-decisao/main/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo deste roteiro \u00e9 utilizar as bibliotecas <code>pandas</code>, <code>numpy</code>, <code>matplotlib</code> e <code>scikit-learn</code>, al\u00e9m da base de dados escolhida no Kagle, para treinar e avaliar um algoritmo de \u00e1rvore de decis\u00e3o. A proposta \u00e9 verificar como vari\u00e1veis como est\u00e1dio, p\u00fablico, posse de bola, passes e chances criadas influenciam no resultado final da partida (<code>class</code>), permitindo explorar o uso de modelos de Machine Learning no contexto esportivo.</p>"},{"location":"arvore-decisao/main/#base-de-dados","title":"Base de dados","text":"<p>A base de dados utilizada neste projeto cont\u00e9m informa\u00e7\u00f5es de partidas de futebol, totalizando 1140 linhas e 40 colunas. Entre as vari\u00e1veis est\u00e3o posse de bola, n\u00famero de passes e chances criadas. A vari\u00e1vel alvo escolhida \u00e9 a coluna <code>class</code>, que indica o resultado da partida (vit\u00f3ria do mandante, empate ou vit\u00f3ria do visitante), sendo o objeto da classifica\u00e7\u00e3o pelo algoritmo de \u00e1rvore de decis\u00e3o.</p>"},{"location":"arvore-decisao/main/#exploracao-dos-dados","title":"Explora\u00e7\u00e3o dos Dados","text":"<p>A seguir foi feita uma an\u00e1lise do significado e composi\u00e7\u00e3o de cada coluna presente na base, com a finalidade de identificar poss\u00edveis problemas a serem tratados posteriormente. As visualiza\u00e7\u00f5es e estat\u00edsticas descritivas ajudam a compreender a natureza dos dados e orientar decis\u00f5es de pr\u00e9-processamento e modelagem.</p> classattendancestadiumhome_possessionsaway_possessionsHome TeamAway Teamhome_passaway_passhome_chancesaway_chances <p>A coluna <code>class</code> \u00e9 a vari\u00e1vel alvo do projeto e representa o resultado da partida: vit\u00f3ria do mandante (\"h\"), empate (\"d\") ou vit\u00f3ria do visitante (\"a\").  Trata-se de uma vari\u00e1vel categ\u00f3rica com tr\u00eas poss\u00edveis valores, sendo o objeto de classifica\u00e7\u00e3o do modelo de \u00e1rvore de decis\u00e3o.  A an\u00e1lise explorat\u00f3ria dessa coluna \u00e9 essencial para observar o balanceamento do conjunto de dados, isto \u00e9, se h\u00e1 propor\u00e7\u00f5es semelhantes ou discrepantes entre os resultados poss\u00edveis.</p> 2025-12-09T12:44:31.617641 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>attendance</code> representa o p\u00fablico presente em cada partida, um indicador de contexto do jogo que pode refletir fatores como mando de campo, relev\u00e2ncia do confronto e engajamento da torcida. Em bases de futebol, o p\u00fablico tende a variar bastante entre est\u00e1dios e rodadas, podendo apresentar assimetria (jogos muito cheios em arenas grandes) e valores at\u00edpicos (cl\u00e1ssicos, finais).</p> <p>Do ponto de vista anal\u00edtico, \u00e9 uma vari\u00e1vel cont\u00ednua \u00fatil para observar a distribui\u00e7\u00e3o de torcedores ao longo das partidas e investigar rela\u00e7\u00f5es com o resultado (<code>class</code>).</p> 2025-12-09T12:44:31.691568 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>stadium</code> identifica o est\u00e1dio onde a partida foi disputada. Trata-se de uma vari\u00e1vel categ\u00f3rica, associada ao contexto e \u00e0 capacidade do local, podendo refletir fatores como mando de campo, perfil da torcida, relevo do gramado e at\u00e9 particularidades log\u00edsticas.  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por est\u00e1dio, verificando balanceamento da amostra (quais arenas t\u00eam mais/menos partidas) e poss\u00edveis vieses (ex.: concentra\u00e7\u00e3o em poucos est\u00e1dios).  Rela\u00e7\u00f5es mais profundas com o resultado (<code>class</code>) podem ser investigadas em etapas seguintes, mas aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel no conjunto de dados.</p> 2025-12-09T12:44:31.876324 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_possessions</code> representa a porcentagem de posse de bola do time mandante em cada partida.  Trata-se de uma vari\u00e1vel num\u00e9rica cont\u00ednua, normalmente variando entre 30% e 70% na maioria dos jogos, podendo indicar estilos de jogo (times que mant\u00eam a bola ou que jogam mais reativamente).  A an\u00e1lise explorat\u00f3ria dessa vari\u00e1vel permite observar a distribui\u00e7\u00e3o da posse de bola entre os mandantes, identificar valores at\u00edpicos e comparar a m\u00e9dia do controle de jogo ao longo das rodadas.  Posteriormente, poder\u00e1 ser interessante relacionar essa posse com o resultado final (<code>class</code>) para verificar padr\u00f5es.</p> 2025-12-09T12:44:32.058592 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_possessions</code> representa a porcentagem de posse de bola do time visitante em cada partida.  Por ser uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o ajuda a observar o comportamento dos visitantes em termos de controle de jogo, identificar valores at\u00edpicos e comparar a tend\u00eancia m\u00e9dia de posse fora de casa.  Em etapas posteriores, pode ser relacionada ao resultado (<code>class</code>) para investigar padr\u00f5es de desempenho como visitante.</p> 2025-12-09T12:44:32.193060 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Home Team</code> identifica o time mandante na partida. Embora esteja codificada numericamente no dataset, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por mandante, verificando o balanceamento da amostra entre os times que atuam em casa e poss\u00edveis concentra\u00e7\u00f5es.  Rela\u00e7\u00f5es com o resultado (<code>class</code>) podem ser exploradas depois; aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel.</p> 2025-12-09T12:44:32.356306 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Away Team</code> identifica o time visitante na partida. Apesar de codificada como n\u00famero, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, observar a frequ\u00eancia de jogos por visitante ajuda a avaliar o balanceamento da amostra e poss\u00edveis concentra\u00e7\u00f5es de partidas em determinados clubes.</p> 2025-12-09T12:44:32.543561 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_pass</code> indica o n\u00famero de passes realizados pelo time mandante em cada partida.  \u00c9 uma vari\u00e1vel num\u00e9rica cont\u00ednua que ajuda a caracterizar o estilo de jogo do mandante, podendo variar bastante entre equipes mais ou menos dependentes da posse de bola.  Na an\u00e1lise explorat\u00f3ria, observar a distribui\u00e7\u00e3o dos passes permite identificar m\u00e9dias, dispers\u00e3o e valores at\u00edpicos.</p> 2025-12-09T12:44:32.706512 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_pass</code> indica o n\u00famero de passes realizados pelo time visitante em cada partida.  Sendo uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o mostra como os visitantes se comportam em termos de constru\u00e7\u00e3o de jogadas e controle de posse fora de casa.  A an\u00e1lise explorat\u00f3ria ajuda a entender a m\u00e9dia de passes, varia\u00e7\u00f5es entre os jogos e eventuais valores extremos.</p> 2025-12-09T12:44:32.897231 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_chances</code> representa a quantidade de chances de gol criadas pelo time mandante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que indica o n\u00edvel de ofensividade da equipe jogando em casa.  A an\u00e1lise explorat\u00f3ria permite identificar a frequ\u00eancia de jogos com poucas ou muitas oportunidades e verificar a dispers\u00e3o desse tipo de estat\u00edstica.</p> 2025-12-09T12:44:33.034572 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_chances</code> indica a quantidade de chances de gol criadas pelo time visitante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que ajuda a compreender a ofensividade dos times jogando fora de casa.  A an\u00e1lise explorat\u00f3ria mostra como os visitantes se comportam em termos de cria\u00e7\u00e3o de oportunidades, permitindo identificar padr\u00f5es de equil\u00edbrio ou diferen\u00e7as marcantes em rela\u00e7\u00e3o aos mandantes.</p> 2025-12-09T12:44:33.172583 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/"},{"location":"arvore-decisao/main/#pre-processamento","title":"Pr\u00e9-processamento","text":"<p>Ap\u00f3s a explora\u00e7\u00e3o inicial da base, foram aplicados procedimentos de pr\u00e9-processamento para preparar os dados para o treinamento do modelo. Entre as etapas realizadas est\u00e3o:</p> <ul> <li>Convers\u00e3o de tipos: vari\u00e1veis originalmente em texto com valores num\u00e9ricos (como <code>attendance</code>) foram transformadas em formato num\u00e9rico.  </li> <li>Tratamento de valores categ\u00f3ricos: colunas como <code>stadium</code>, <code>Home Team</code> e <code>Away Team</code> foram mantidas como categ\u00f3ricas, sendo posteriormente convertidas em vari\u00e1veis num\u00e9ricas por meio de t\u00e9cnicas de codifica\u00e7\u00e3o.  </li> <li>Remo\u00e7\u00e3o de colunas irrelevantes ou redundantes: colunas de identifica\u00e7\u00e3o e de tempo (<code>date</code>, <code>clock</code>, <code>links</code>), bem como estat\u00edsticas que representam vazamento de informa\u00e7\u00e3o do resultado (ex.: <code>Goals Home</code>, <code>Away Goals</code>), foram descartadas do conjunto de treino.  </li> <li>Separa\u00e7\u00e3o entre features e target: as vari\u00e1veis explicativas (<code>X</code>) foram definidas a partir de aproximadamente dez colunas relevantes da base, enquanto a vari\u00e1vel alvo (<code>y</code>) \u00e9 a coluna <code>class</code>.  </li> <li>Divis\u00e3o em treino e teste: o conjunto de dados foi dividido em duas partes, garantindo estratifica\u00e7\u00e3o do alvo para manter o equil\u00edbrio das classes.</li> </ul> <p>Com essas etapas, os dados foram organizados de forma consistente, reduzindo ru\u00eddos e preparando a base para a etapa seguinte: o treinamento do modelo de \u00e1rvore de decis\u00e3o.</p> Base preparadacodeBase original stadium class attendance Home Team Away Team home_possessions away_possessions home_pass away_pass home_chances away_chances 12 2 0 13 5 52.7 47.3 79.1 75.8 1 1 5 0 24244 10 16 50 50 79 77 2 1 13 2 73088 3 5 36.8 63.2 81.7 89.1 2 5 1 0 31507 6 20 63 37 91.7 79.6 1 1 13 1 73439 3 20 46.7 53.3 78 84.5 2 1 2 0 53213 5 17 82.4 17.6 89.1 54.9 2 0 9 2 38834 17 21 50.1 49.9 75.3 73.7 2 6 21 0 59647 8 17 55 45 89.7 86.2 6 0 0 2 0 8 18 56.4 43.6 78.8 79.1 1 0 10 2 17009 9 1 23.7 76.3 62.7 88.5 0 1 15 1 44017 4 20 36.3 63.7 69.3 85.9 1 2 <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\nprint(df.sample(frac=.01).to_markdown(index=False))\n</code></pre> date clock stadium class attendance Home Team Goals Home Away Team Away Goals home_possessions away_possessions home_shots away_shots home_on away_on home_off away_off home_blocked away_blocked home_pass away_pass home_chances away_chances home_corners away_corners home_offside away_offside home_tackles away_tackles home_duels away_duels home_saves away_saves home_fouls away_fouls home_yellow away_yellow home_red away_red links 2nd October 2022 4:30pm Elland Road d 36,582 19 0 7 0 43.8 56.2 6 19 1 7 2 8 3 4 72 77.2 0 3 2 9 0 2 75 68.8 42.1 57.9 6 1 23 12 3 2 1 0 https://www.skysports.com/football/leeds-united-vs-aston-villa/464719 20/09/2020 7:00pm The King Power Stadium h 0 18 4 23 2 67.8 32.2 14 16 6 5 2 8 6 3 84.7 68.2 0 2 15 4 0 1 46.2 50 37.5 62.5 3 3 11 13 1 2 0 0 https://www.skysports.com/football/leicester-city-vs-burnley/stats/428852 23rd January 2022 4:30pm Stamford Bridge h 40,020 12 2 8 0 64.6 35.4 15 6 7 3 5 2 3 1 86.8 78.3 1 0 10 3 0 1 73.3 50 61.9 38.1 3 5 17 14 2 1 0 0 https://www.skysports.com/football/chelsea-vs-tottenham-hotspur/stats/446510 18th October 2022 8:15pm Selhurst Park h 25,125 11 2 13 1 51.3 48.7 14 10 4 4 5 5 5 1 82.4 79.4 2 2 4 3 0 4 52.2 51.7 58.6 41.4 3 2 14 18 3 1 0 0 https://www.skysports.com/football/crystal-palace-vs-wolverhampton-wanderers/464749 25th February 2023 3:00pm Elland Road h 36,641 19 1 20 0 60.6 39.4 14 8 4 2 6 3 4 3 84.6 77.7 0 0 9 2 2 3 65.2 55.6 52.2 47.8 2 3 15 13 2 4 0 0 https://www.skysports.com/football/leeds-united-vs-southampton/464879 30th April 2023 2:00pm Old Trafford h 73,592 3 1 7 0 57.1 42.9 14 7 6 1 6 2 2 4 84.9 78.1 1 0 1 4 7 3 78.6 46.7 50 50 1 5 16 7 2 0 0 0 https://www.skysports.com/football/manchester-united-vs-aston-villa/464973 14/01/2021 8:00pm Emirates Stadium d 0 2 0 11 0 67.2 32.8 11 12 4 2 5 6 2 4 86.7 76 0 0 7 3 1 1 47.1 50 54.8 45.2 2 4 11 11 1 1 0 0 https://www.skysports.com/football/arsenal-vs-crystal-palace/stats/429007 26th December 2021 3:00pm Etihad Stadium h 53,226 1 6 18 3 71.8 28.2 17 14 9 8 3 5 5 1 94.2 86.6 2 4 14 4 2 1 42.9 66.7 40 60 5 2 11 9 1 2 0 0 https://www.skysports.com/football/manchester-city-vs-leicester-city/stats/446472 4th February 2023 3:00pm Old Trafford h 73,420 3 2 11 1 53.1 46.9 14 10 5 3 5 5 4 2 85.4 80.3 0 2 5 5 1 4 57.1 56.3 57.9 42.1 2 3 9 9 1 2 1 0 https://www.skysports.com/football/manchester-united-vs-crystal-palace/464850 27th December 2022 5:30pm Stamford Bridge h 40,046 12 2 15 0 60.3 39.7 15 9 5 4 7 4 3 1 88.3 81.2 2 0 6 8 3 0 58.8 64.7 42.1 57.9 4 3 8 10 0 0 0 0 https://www.skysports.com/football/chelsea-vs-bournemouth/464798 27/09/2020 5:45pm Craven Cottage a 0 10 0 7 3 65 35 16 12 3 5 9 4 4 3 85.7 70.5 0 4 5 3 0 3 44.4 69.6 48.7 51.3 2 2 18 14 6 3 0 0 https://www.skysports.com/football/fulham-vs-aston-villa/stats/428860"},{"location":"arvore-decisao/main/#divisao-dos-dados","title":"Divis\u00e3o dos Dados","text":"<p>Com a base pr\u00e9-processada, realizou-se a divis\u00e3o entre conjuntos de treinamento e teste. O objetivo dessa etapa \u00e9 garantir que o modelo seja avaliado em dados que ele nunca viu durante o treinamento, permitindo uma medida mais confi\u00e1vel de sua capacidade de generaliza\u00e7\u00e3o.  </p> <p>Foi utilizada a fun\u00e7\u00e3o <code>train_test_split</code> da biblioteca scikit-learn, com os seguintes crit\u00e9rios: - 70% dos dados destinados ao treinamento, para que o modelo aprenda os padr\u00f5es da base; - 30% dos dados destinados ao teste, para avaliar o desempenho em novos exemplos; - Estratifica\u00e7\u00e3o pelo alvo (<code>class</code>), garantindo que a propor\u00e7\u00e3o entre vit\u00f3rias do mandante, empates e vit\u00f3rias do visitante fosse mantida em ambos os conjuntos; - Random State fixado, assegurando reprodutibilidade na divis\u00e3o.  </p> <p>Dessa forma, o conjunto de treinamento foi usado para ajustar os par\u00e2metros da \u00e1rvore de decis\u00e3o, enquanto o conjunto de teste serviu para medir a precis\u00e3o e robustez do modelo.</p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\n# Vari\u00e1veis independentes (features)\nx = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]]\n\n# Vari\u00e1vel dependente (alvo)\ny = df[\"class\"]\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=27, stratify=y)\n</code></pre>"},{"location":"arvore-decisao/main/#treinamento-do-modelo","title":"Treinamento do Modelo","text":"Modelo da \u00c1rvorecode <p>Precis\u00e3o da Valida\u00e7\u00e3o: 0.47 Import\u00e2ncia das Features:  Feature Import\u00e2ncia 6 home_pass 0.149653 7 away_pass 0.137838 2 Home Team 0.117601 9 away_chances 0.110549 3 Away Team 0.109458 1 attendance 0.106165 5 away_possessions 0.076208 8 home_chances 0.070173 0 stadium 0.063028 4 home_possessions 0.059329 2025-12-09T12:44:34.657907 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ </p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\n# Vari\u00e1veis independentes (features)\nx = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]]\n\n# Vari\u00e1vel dependente (alvo)\ny = df[\"class\"]\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=27, stratify=y)\n\n# Criar e treinar o modelo de \u00e1rvore de decis\u00e3o\nclassifier = tree.DecisionTreeClassifier()\nclassifier.fit(x_train, y_train)\n\n# Avaliar o modelo\ny_pred = classifier.predict(x_test)\naccuracy = accuracy_score(y_test, y_pred)\nprint(f\"Precis\u00e3o da Valida\u00e7\u00e3o: {accuracy:.2f}\")\n\nfeature_importance = pd.DataFrame({\n    'Feature': classifier.feature_names_in_,\n    'Import\u00e2ncia': classifier.feature_importances_\n})\nprint(\"&lt;br&gt;Import\u00e2ncia das Features:\")\nprint(feature_importance.sort_values(by='Import\u00e2ncia', ascending=False).to_html())\n\nplt.figure(figsize=(20, 10))\ntree.plot_tree(classifier, max_depth=5, fontsize=10)\n\n# Para imprimir na p\u00e1gina HTML\nbuffer = StringIO()\nplt.savefig(buffer, format=\"svg\")\nprint(buffer.getvalue())    \n</code></pre>"},{"location":"arvore-decisao/main/#avaliacao-do-modelo","title":"Avalia\u00e7\u00e3o do Modelo","text":"<p>Ap\u00f3s o treinamento da \u00e1rvore de decis\u00e3o, o modelo foi avaliado no conjunto de teste, obtendo uma precis\u00e3o (accuracy) de aproximadamente 0.48. Esse valor mostra que o modelo acerta menos da metade das previs\u00f5es, o que indica uma performance limitada.  </p> <p>Contudo, esse resultado deve ser entendido \u00e0 luz da natureza do problema: prever o resultado de uma partida de futebol \u00e9 uma tarefa de alta complexidade e incerteza. Al\u00e9m das estat\u00edsticas presentes na base, fatores externos como clima, les\u00f5es, decis\u00f5es de arbitragem, motiva\u00e7\u00e3o individual e at\u00e9 elementos de acaso influenciam diretamente no desfecho do jogo. Mesmo com acesso a uma base de dados mais ampla, a previs\u00e3o exata de partidas continuaria sendo altamente incerta, pois o futebol n\u00e3o \u00e9 uma ci\u00eancia exata, mas um evento esportivo com vari\u00e1veis muitas vezes imprevis\u00edveis.  </p> <p>Algumas observa\u00e7\u00f5es complementares ajudam a interpretar esse desempenho: - Baixa capacidade preditiva: a \u00e1rvore n\u00e3o conseguiu capturar padr\u00f5es fortes o suficiente para discriminar corretamente as tr\u00eas classes (<code>h</code>, <code>d</code>, <code>a</code>). - Balanceamento do alvo: embora tenha sido aplicada estratifica\u00e7\u00e3o, empates tendem a ser mais raros e dif\u00edceis de prever, prejudicando a acur\u00e1cia global. - Vari\u00e1veis contextuais: as colunas usadas (como est\u00e1dio, p\u00fablico, posse de bola, passes e chances) explicam parte do comportamento da partida, mas n\u00e3o determinam o resultado sozinhas. - Complexidade inerente ao dom\u00ednio: a imprevisibilidade faz parte da pr\u00f3pria ess\u00eancia do futebol, o que limita naturalmente a capacidade de qualquer modelo estat\u00edstico atingir altas taxas de acerto.  </p> <p>Portanto, a precis\u00e3o de 0.48 reflete tanto as limita\u00e7\u00f5es do modelo quanto a complexidade do fen\u00f4meno analisado. O exerc\u00edcio \u00e9 v\u00e1lido n\u00e3o apenas para medir desempenho, mas para evidenciar os desafios de aplicar t\u00e9cnicas de Machine Learning em contextos de elevada incerteza como o esporte.</p>"},{"location":"arvore-decisao/main/#relatorio-final","title":"Relat\u00f3rio Final","text":"<p>O projeto teve como objetivo aplicar um algoritmo de \u00e1rvore de decis\u00e3o sobre uma base de partidas de futebol, explorando o uso de t\u00e9cnicas de Machine Learning em um contexto esportivo.  </p> <p>A an\u00e1lise foi conduzida em etapas bem definidas:</p> <ul> <li> <p>Explora\u00e7\u00e3o dos Dados (EDA): foram selecionadas e analisadas cerca de dez vari\u00e1veis relevantes, entre elas <code>stadium</code>, <code>attendance</code>, <code>Home Team</code>, <code>Away Team</code>, <code>home_possessions</code>, <code>away_possessions</code>, <code>home_pass</code>, <code>away_pass</code>, <code>home_chances</code> e <code>away_chances</code>. A partir de visualiza\u00e7\u00f5es e estat\u00edsticas descritivas, foi poss\u00edvel compreender melhor a natureza de cada coluna e avaliar o balanceamento da vari\u00e1vel alvo <code>class</code>, que representa o resultado da partida.  </p> </li> <li> <p>Pr\u00e9-processamento: nesta fase, colunas de identifica\u00e7\u00e3o e tempo (<code>date</code>, <code>clock</code>, <code>links</code>), bem como estat\u00edsticas diretamente ligadas ao resultado (como gols, finaliza\u00e7\u00f5es e cart\u00f5es), foram removidas para evitar vazamento de informa\u00e7\u00e3o. Al\u00e9m disso, foram realizadas convers\u00f5es de tipos e prepara\u00e7\u00e3o de vari\u00e1veis categ\u00f3ricas para futura codifica\u00e7\u00e3o num\u00e9rica.  </p> </li> <li> <p>Divis\u00e3o dos Dados: o conjunto foi separado em treino (70%) e teste (30%), com estratifica\u00e7\u00e3o do alvo para preservar a propor\u00e7\u00e3o entre vit\u00f3rias do mandante, empates e vit\u00f3rias do visitante. Essa divis\u00e3o assegurou reprodutibilidade e uma avalia\u00e7\u00e3o justa do modelo.  </p> </li> <li> <p>Treinamento e Avalia\u00e7\u00e3o: a \u00e1rvore de decis\u00e3o foi treinada com os dados de treino e avaliada no conjunto de teste. O modelo alcan\u00e7ou uma acur\u00e1cia de aproximadamente 0.48, valor que indica desempenho limitado, mas esperado dentro do contexto.  </p> </li> </ul> <p>A avalia\u00e7\u00e3o evidenciou alguns pontos importantes: - O modelo n\u00e3o conseguiu capturar padr\u00f5es suficientemente fortes, refletindo a alta complexidade da tarefa. - Empates, por serem menos frequentes, foram mais dif\u00edceis de prever, prejudicando a performance global. - As vari\u00e1veis selecionadas (contexto e estat\u00edsticas gerais) ajudam a caracterizar as partidas, mas n\u00e3o s\u00e3o determinantes para o resultado final. - O futebol, por sua pr\u00f3pria natureza, \u00e9 altamente imprevis\u00edvel e sujeito a vari\u00e1veis externas que n\u00e3o est\u00e3o presentes no dataset, como clima, arbitragem, les\u00f5es e fatores psicol\u00f3gicos.  </p>"},{"location":"arvore-decisao/main/#conclusao","title":"Conclus\u00e3o","text":"<p>A experi\u00eancia demonstrou que, embora seja poss\u00edvel aplicar t\u00e9cnicas de Machine Learning ao dom\u00ednio esportivo, os resultados precisam ser interpretados com cautela. O desempenho de 0.48 de acur\u00e1cia n\u00e3o deve ser visto apenas como limita\u00e7\u00e3o do modelo, mas tamb\u00e9m como reflexo da complexidade e da imprevisibilidade inerente ao futebol.  </p> <p>O projeto refor\u00e7a a import\u00e2ncia da an\u00e1lise explorat\u00f3ria, do cuidado no pr\u00e9-processamento para evitar vazamento de dados e da avalia\u00e7\u00e3o cr\u00edtica dos resultados. Al\u00e9m disso, abre espa\u00e7o para trabalhos futuros que explorem vari\u00e1veis adicionais \u2014 como forma recente dos times, desempenho de jogadores e fatores externos \u2014 e ajustes de hiperpar\u00e2metros para buscar melhorias no desempenho do modelo.  </p> <p>Mais do que prever com exatid\u00e3o os resultados, este trabalho mostra o potencial e os limites do uso de algoritmos de aprendizado de m\u00e1quina em contextos reais, nos quais a incerteza e a imprevisibilidade s\u00e3o componentes inevit\u00e1veis.</p>"},{"location":"k-means/main/","title":"K-Means","text":""},{"location":"k-means/main/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo desta etapa foi aplicar o algoritmo K-Means Clustering sobre a base de partidas de futebol da Premier League. Diferente dos modelos anteriores (\u00c1rvore de Decis\u00e3o e KNN), o K-Means \u00e9 um algoritmo n\u00e3o supervisionado, ou seja, n\u00e3o utiliza a vari\u00e1vel-alvo durante o treinamento. A proposta aqui \u00e9 identificar padr\u00f5es ocultos nos dados a partir de estat\u00edsticas das partidas \u2014 como posse de bola, passes, chances criadas, p\u00fablico e est\u00e1dio \u2014 e verificar como esses agrupamentos se relacionam com os resultados reais (<code>class</code>).  </p> <p>Para fins de visualiza\u00e7\u00e3o, os dados foram reduzidos para duas dimens\u00f5es via PCA, permitindo a representa\u00e7\u00e3o gr\u00e1fica dos clusters e seus centr\u00f3ides.</p>"},{"location":"k-means/main/#base-de-dados","title":"Base de dados","text":"<p>A base de dados utilizada neste projeto cont\u00e9m informa\u00e7\u00f5es de partidas de futebol, totalizando 1140 linhas e 40 colunas. Entre as vari\u00e1veis est\u00e3o posse de bola, n\u00famero de passes e chances criadas. A vari\u00e1vel alvo escolhida \u00e9 a coluna <code>class</code>, que indica o resultado da partida (vit\u00f3ria do mandante, empate ou vit\u00f3ria do visitante).</p>"},{"location":"k-means/main/#exploracao-dos-dados","title":"Explora\u00e7\u00e3o dos Dados","text":"<p>A seguir foi feita uma an\u00e1lise do significado e composi\u00e7\u00e3o de cada coluna presente na base, com a finalidade de identificar poss\u00edveis problemas a serem tratados posteriormente. As visualiza\u00e7\u00f5es e estat\u00edsticas descritivas ajudam a compreender a natureza dos dados e orientar decis\u00f5es de pr\u00e9-processamento e modelagem.</p> classattendancestadiumhome_possessionsaway_possessionsHome TeamAway Teamhome_passaway_passhome_chancesaway_chances <p>A coluna <code>class</code> \u00e9 a vari\u00e1vel alvo do projeto e representa o resultado da partida: vit\u00f3ria do mandante (\"h\"), empate (\"d\") ou vit\u00f3ria do visitante (\"a\").  Trata-se de uma vari\u00e1vel categ\u00f3rica com tr\u00eas poss\u00edveis valores, sendo o objeto de classifica\u00e7\u00e3o do modelo de \u00e1rvore de decis\u00e3o.  A an\u00e1lise explorat\u00f3ria dessa coluna \u00e9 essencial para observar o balanceamento do conjunto de dados, isto \u00e9, se h\u00e1 propor\u00e7\u00f5es semelhantes ou discrepantes entre os resultados poss\u00edveis.</p> 2025-12-09T12:44:35.727509 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>attendance</code> representa o p\u00fablico presente em cada partida, um indicador de contexto do jogo que pode refletir fatores como mando de campo, relev\u00e2ncia do confronto e engajamento da torcida. Em bases de futebol, o p\u00fablico tende a variar bastante entre est\u00e1dios e rodadas, podendo apresentar assimetria (jogos muito cheios em arenas grandes) e valores at\u00edpicos (cl\u00e1ssicos, finais).</p> <p>Do ponto de vista anal\u00edtico, \u00e9 uma vari\u00e1vel cont\u00ednua \u00fatil para observar a distribui\u00e7\u00e3o de torcedores ao longo das partidas e investigar rela\u00e7\u00f5es com o resultado (<code>class</code>).</p> 2025-12-09T12:44:35.801985 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>stadium</code> identifica o est\u00e1dio onde a partida foi disputada. Trata-se de uma vari\u00e1vel categ\u00f3rica, associada ao contexto e \u00e0 capacidade do local, podendo refletir fatores como mando de campo, perfil da torcida, relevo do gramado e at\u00e9 particularidades log\u00edsticas.  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por est\u00e1dio, verificando balanceamento da amostra (quais arenas t\u00eam mais/menos partidas) e poss\u00edveis vieses (ex.: concentra\u00e7\u00e3o em poucos est\u00e1dios).  Rela\u00e7\u00f5es mais profundas com o resultado (<code>class</code>) podem ser investigadas em etapas seguintes, mas aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel no conjunto de dados.</p> 2025-12-09T12:44:35.988867 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_possessions</code> representa a porcentagem de posse de bola do time mandante em cada partida.  Trata-se de uma vari\u00e1vel num\u00e9rica cont\u00ednua, normalmente variando entre 30% e 70% na maioria dos jogos, podendo indicar estilos de jogo (times que mant\u00eam a bola ou que jogam mais reativamente).  A an\u00e1lise explorat\u00f3ria dessa vari\u00e1vel permite observar a distribui\u00e7\u00e3o da posse de bola entre os mandantes, identificar valores at\u00edpicos e comparar a m\u00e9dia do controle de jogo ao longo das rodadas.  Posteriormente, poder\u00e1 ser interessante relacionar essa posse com o resultado final (<code>class</code>) para verificar padr\u00f5es.</p> 2025-12-09T12:44:36.170945 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_possessions</code> representa a porcentagem de posse de bola do time visitante em cada partida.  Por ser uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o ajuda a observar o comportamento dos visitantes em termos de controle de jogo, identificar valores at\u00edpicos e comparar a tend\u00eancia m\u00e9dia de posse fora de casa.  Em etapas posteriores, pode ser relacionada ao resultado (<code>class</code>) para investigar padr\u00f5es de desempenho como visitante.</p> 2025-12-09T12:44:36.307155 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Home Team</code> identifica o time mandante na partida. Embora esteja codificada numericamente no dataset, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por mandante, verificando o balanceamento da amostra entre os times que atuam em casa e poss\u00edveis concentra\u00e7\u00f5es.  Rela\u00e7\u00f5es com o resultado (<code>class</code>) podem ser exploradas depois; aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel.</p> 2025-12-09T12:44:36.469429 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Away Team</code> identifica o time visitante na partida. Apesar de codificada como n\u00famero, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, observar a frequ\u00eancia de jogos por visitante ajuda a avaliar o balanceamento da amostra e poss\u00edveis concentra\u00e7\u00f5es de partidas em determinados clubes.</p> 2025-12-09T12:44:36.655860 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_pass</code> indica o n\u00famero de passes realizados pelo time mandante em cada partida.  \u00c9 uma vari\u00e1vel num\u00e9rica cont\u00ednua que ajuda a caracterizar o estilo de jogo do mandante, podendo variar bastante entre equipes mais ou menos dependentes da posse de bola.  Na an\u00e1lise explorat\u00f3ria, observar a distribui\u00e7\u00e3o dos passes permite identificar m\u00e9dias, dispers\u00e3o e valores at\u00edpicos.</p> 2025-12-09T12:44:36.815173 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_pass</code> indica o n\u00famero de passes realizados pelo time visitante em cada partida.  Sendo uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o mostra como os visitantes se comportam em termos de constru\u00e7\u00e3o de jogadas e controle de posse fora de casa.  A an\u00e1lise explorat\u00f3ria ajuda a entender a m\u00e9dia de passes, varia\u00e7\u00f5es entre os jogos e eventuais valores extremos.</p> 2025-12-09T12:44:36.949445 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_chances</code> representa a quantidade de chances de gol criadas pelo time mandante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que indica o n\u00edvel de ofensividade da equipe jogando em casa.  A an\u00e1lise explorat\u00f3ria permite identificar a frequ\u00eancia de jogos com poucas ou muitas oportunidades e verificar a dispers\u00e3o desse tipo de estat\u00edstica.</p> 2025-12-09T12:44:37.190692 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_chances</code> indica a quantidade de chances de gol criadas pelo time visitante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que ajuda a compreender a ofensividade dos times jogando fora de casa.  A an\u00e1lise explorat\u00f3ria mostra como os visitantes se comportam em termos de cria\u00e7\u00e3o de oportunidades, permitindo identificar padr\u00f5es de equil\u00edbrio ou diferen\u00e7as marcantes em rela\u00e7\u00e3o aos mandantes.</p> 2025-12-09T12:44:37.326921 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/"},{"location":"k-means/main/#pre-processamento","title":"Pr\u00e9-processamento","text":"<p>Ap\u00f3s a explora\u00e7\u00e3o inicial da base, foram aplicados procedimentos de pr\u00e9-processamento para preparar os dados para o treinamento do modelo. Entre as etapas realizadas est\u00e3o:</p> <ul> <li>Convers\u00e3o de tipos: vari\u00e1veis originalmente em texto com valores num\u00e9ricos (como <code>attendance</code>) foram transformadas em formato num\u00e9rico.  </li> <li>Tratamento de valores categ\u00f3ricos: colunas como <code>stadium</code>, <code>Home Team</code> e <code>Away Team</code> foram mantidas como categ\u00f3ricas, sendo posteriormente convertidas em vari\u00e1veis num\u00e9ricas por meio de t\u00e9cnicas de codifica\u00e7\u00e3o.  </li> <li>Remo\u00e7\u00e3o de colunas irrelevantes ou redundantes: colunas de identifica\u00e7\u00e3o e de tempo (<code>date</code>, <code>clock</code>, <code>links</code>), bem como estat\u00edsticas que representam vazamento de informa\u00e7\u00e3o do resultado (ex.: <code>Goals Home</code>, <code>Away Goals</code>), foram descartadas do conjunto de treino.  </li> <li>Separa\u00e7\u00e3o entre features e target: as vari\u00e1veis explicativas (<code>X</code>) foram definidas a partir de aproximadamente dez colunas relevantes da base, enquanto a vari\u00e1vel alvo (<code>y</code>) \u00e9 a coluna <code>class</code>.  </li> <li>Divis\u00e3o em treino e teste: o conjunto de dados foi dividido em duas partes, garantindo estratifica\u00e7\u00e3o do alvo para manter o equil\u00edbrio das classes.</li> </ul> Base preparadacodeBase original stadium class attendance Home Team Away Team home_possessions away_possessions home_pass away_pass home_chances away_chances 22 1 0 23 10 46 54 68 73.2 1 0 18 0 29154 16 20 35.9 64.1 69.6 83.4 1 4 10 2 16982 9 13 49.5 50.5 73.6 74.4 0 0 21 2 60059 8 12 47 53 82.3 87 1 3 10 0 17032 9 14 47.1 52.9 83.4 84.3 2 0 24 2 0 7 6 55.4 44.6 83.4 81.3 2 3 5 0 0 10 24 45.7 54.3 76.7 79.1 1 0 12 0 0 13 12 45.1 54.9 80.4 85.8 1 1 20 2 0 18 4 68.3 31.7 86.7 71.2 3 3 6 0 36304 19 15 60.9 39.1 81.7 73 1 2 2 0 52824 5 9 68.3 31.7 82.7 62.6 4 0 <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\nprint(df.sample(frac=.01).to_markdown(index=False))\n</code></pre> date clock stadium class attendance Home Team Goals Home Away Team Away Goals home_possessions away_possessions home_shots away_shots home_on away_on home_off away_off home_blocked away_blocked home_pass away_pass home_chances away_chances home_corners away_corners home_offside away_offside home_tackles away_tackles home_duels away_duels home_saves away_saves home_fouls away_fouls home_yellow away_yellow home_red away_red links 24th April 2022 2:00pm Amex Stadium d 31,335 6 2 20 2 48.8 51.2 8 18 5 5 0 6 3 7 65.1 70.5 1 0 6 6 2 3 47.1 30.8 53.3 46.7 3 4 12 7 1 0 0 0 https://www.skysports.com/football/brighton-and-hove-albion-vs-southampton/stats/446620 4th February 2023 3:00pm Gtech Community Stadium h 17,051 9 3 20 0 48.3 51.7 14 14 4 6 6 4 4 4 69.2 75.6 3 1 4 4 1 2 53.8 66.7 44.4 55.6 5 0 10 9 1 2 0 0 https://www.skysports.com/football/brentford-vs-southampton/464846 25th September 2021 3:00pm The King Power Stadium d 31,650 18 2 23 2 67.1 32.9 22 9 5 3 6 4 11 2 83.7 67.5 2 0 8 4 1 4 82.4 38.5 52.6 47.4 2 2 10 8 2 4 0 0 https://www.skysports.com/football/leicester-city-vs-burnley/stats/446344 9/5/2021 7:00pm Emirates Stadium h 0 2 3 24 1 65.7 34.3 15 12 7 1 5 7 3 4 86.3 72.9 1 3 6 6 1 2 72.7 78.6 47.8 52.2 0 4 7 9 1 2 0 0 https://www.skysports.com/football/arsenal-vs-west-bromwich-albion/stats/429177 4th March 2023 3:00pm Emirates Stadium h 60,222 2 3 15 2 80.1 19.9 31 4 9 4 10 0 12 0 88.6 57.6 1 2 17 1 0 0 58.8 75 55.9 44.1 2 6 6 8 0 2 0 0 https://www.skysports.com/football/arsenal-vs-bournemouth/464885 12/9/2020 12:30pm Craven Cottage a 0 10 0 2 3 45.6 54.4 5 13 2 6 2 4 1 3 88.1 89.8 0 1 2 3 2 2 63.6 41.7 53.3 46.7 2 2 12 12 2 2 0 0 https://www.skysports.com/football/fulham-vs-arsenal/stats/428839 30th August 2022 8:00pm Elland Road d 36,338 19 1 17 1 69.1 30.9 14 7 5 2 8 2 1 3 83.1 69.5 1 3 10 2 2 2 52 46.4 66.7 33.3 1 4 10 9 3 3 0 0 https://www.skysports.com/football/leeds-united-vs-everton/464679 22/11/2020 4:30pm Elland Road d 0 19 0 2 0 66.3 33.7 25 9 4 2 16 6 5 1 85 70.9 2 1 5 3 0 2 50 50 52.4 47.6 2 4 9 8 3 0 0 1 https://www.skysports.com/football/leeds-united-vs-arsenal/stats/428920 28/02/2021 12:00pm The King Power Stadium a 0 18 1 2 3 44.2 55.8 8 12 3 4 2 4 3 4 77.5 82.6 0 0 2 7 0 1 57.1 88.9 51.9 48.1 1 2 15 3 2 1 0 0 https://www.skysports.com/football/leicester-city-vs-arsenal/stats/429091 15th October 2022 3:00pm Molineux h 31,554 13 1 16 0 58 42 9 10 2 2 5 6 2 2 81.6 71.9 0 0 4 5 2 1 47.1 37.5 34.6 65.4 2 1 17 13 2 2 0 0 https://www.skysports.com/football/wolverhampton-wanderers-vs-nottingham-forest/464744 30/11/2020 8:00pm London Stadium h 0 14 2 7 1 34.9 65.1 6 16 2 6 1 7 3 3 65.4 82.7 1 2 3 7 1 3 50 66.7 45.8 54.2 5 0 20 7 1 1 0 0 https://www.skysports.com/football/west-ham-united-vs-aston-villa/stats/428936"},{"location":"k-means/main/#divisao-dos-dados","title":"Divis\u00e3o dos Dados","text":"<p>Com a base pr\u00e9-processada, realizou-se a divis\u00e3o entre conjuntos de treinamento e teste. O objetivo dessa etapa \u00e9 garantir que o modelo seja avaliado em dados que ele nunca viu durante o treinamento, permitindo uma medida mais confi\u00e1vel de sua capacidade de generaliza\u00e7\u00e3o.  </p> <p>Foi utilizada a fun\u00e7\u00e3o <code>train_test_split</code> da biblioteca scikit-learn, com os seguintes crit\u00e9rios: - 70% dos dados destinados ao treinamento, para que o modelo aprenda os padr\u00f5es da base; - 30% dos dados destinados ao teste, para avaliar o desempenho em novos exemplos; - Estratifica\u00e7\u00e3o pelo alvo (<code>class</code>), garantindo que a propor\u00e7\u00e3o entre vit\u00f3rias do mandante, empates e vit\u00f3rias do visitante fosse mantida em ambos os conjuntos; - Random State fixado, assegurando reprodutibilidade na divis\u00e3o.  </p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\n# Vari\u00e1veis independentes (features)\nx = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]]\n\n# Vari\u00e1vel dependente (alvo)\ny = df[\"class\"]\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=27, stratify=y)\n</code></pre>"},{"location":"k-means/main/#treinamento-do-modelo","title":"Treinamento do Modelo","text":"<p>O modelo foi treinado com 3 clusters, em refer\u00eancia \u00e0s tr\u00eas classes poss\u00edveis do resultado da partida: vit\u00f3ria do mandante, empate e vit\u00f3ria do visitante.  </p> <p>Ap\u00f3s o pr\u00e9-processamento (padroniza\u00e7\u00e3o das vari\u00e1veis num\u00e9ricas e transforma\u00e7\u00e3o das categ\u00f3ricas em dummies), o algoritmo K-Means foi aplicado sobre os dados transformados. Em seguida, os dados foram projetados em duas dimens\u00f5es com PCA para permitir a visualiza\u00e7\u00e3o gr\u00e1fica.  </p> <p>Na figura abaixo \u00e9 poss\u00edvel observar a forma\u00e7\u00e3o dos tr\u00eas clusters identificados pelo algoritmo e seus respectivos centr\u00f3ides (em vermelho):</p> ModeloC\u00f3digo <p> </p> <pre><code>import base64\nfrom io import BytesIO\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\nnum_cols = [\n    \"attendance\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\",\n]\ncat_cols = [\"stadium\", \"Home Team\", \"Away Team\"]\n\ndf[\"attendance\"] = (\n    df[\"attendance\"].astype(str).str.replace(r\"[^0-9]\", \"\", regex=True).replace(\"\", \"0\").astype(float)\n)\nfor c in num_cols:\n    df[c] = pd.to_numeric(df[c], errors=\"coerce\").fillna(df[c].median())\n\nX_cat = pd.get_dummies(\n    df[cat_cols].astype(str).apply(lambda s: s.str.strip()),\n    drop_first=False, dtype=int\n)\n\nscaler = StandardScaler()\nX_num = df[num_cols].copy()\nX_num[num_cols] = scaler.fit_transform(X_num[num_cols])\n\nX = pd.concat([X_num, X_cat], axis=1).values\n\npca = PCA(n_components=2)\nX_pca = pca.fit_transform(X)\n\nkmeans = KMeans(n_clusters=3, init=\"k-means++\", max_iter=300, n_init=10, random_state=42)\nlabels = kmeans.fit_predict(X_pca)\n\nplt.figure(figsize=(12, 10))\nplt.scatter(X_pca[:, 0], X_pca[:, 1], c=labels, cmap=\"viridis\", s=50)\nplt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1],\n            c=\"red\", marker=\"*\", s=220, label=\"Centroids\")\nplt.title(\"K-Means Clustering (Football Matches) - PCA 2D\")\nplt.xlabel(\"PCA 1\")\nplt.ylabel(\"PCA 2\")\nplt.legend()\n\nbuf = BytesIO()\nplt.savefig(buf, format=\"png\", transparent=True, bbox_inches=\"tight\")\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode(\"utf-8\")\nhtml_img = f'&lt;img src=\"data:image/png;base64,{img_base64}\" alt=\"KMeans clustering\" /&gt;'\nprint(html_img)\n</code></pre> <p>Esse resultado mostra que o algoritmo conseguiu dividir os dados em agrupamentos distintos, mas com fronteiras de separa\u00e7\u00e3o difusas, j\u00e1 que as estat\u00edsticas utilizadas n\u00e3o garantem divis\u00f5es claras entre os diferentes resultados das partidas.</p>"},{"location":"k-means/main/#avaliacao-do-modelo","title":"Avalia\u00e7\u00e3o do Modelo","text":"<p>Para avaliar a qualidade do clustering, os r\u00f3tulos de clusters foram mapeados para as classes reais (<code>class</code>) por meio de um voto majorit\u00e1rio dentro de cada grupo. Dessa forma, foi poss\u00edvel calcular m\u00e9tricas de classifica\u00e7\u00e3o mesmo em um cen\u00e1rio originalmente n\u00e3o supervisionado.  </p> <p>O modelo obteve uma acur\u00e1cia aproximada de 47.92%, com a seguinte matriz de confus\u00e3o:</p> ResultadoC\u00f3digo <p>Acur\u00e1cia: 47.92% Matriz de Confus\u00e3o:  Classe Pred 0 Classe Pred 1 Classe Pred 2 Classe Real 0 254 0 141 Classe Real 1 107 0 98 Classe Real 2 129 0 183 </p> <pre><code>import pandas as pd\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\nnum_cols = [\n    \"attendance\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\",\n]\ncat_cols = [\"stadium\", \"Home Team\", \"Away Team\"]\ntarget = \"class\"\n\ndf[\"attendance\"] = (\n    df[\"attendance\"]\n      .astype(str)\n      .str.replace(r\"[^0-9]\", \"\", regex=True)\n      .replace(\"\", \"0\")\n      .astype(float)\n)\nfor c in num_cols:\n    df[c] = pd.to_numeric(df[c], errors=\"coerce\")\n    df[c] = df[c].fillna(df[c].median())\n\nX_cat = pd.get_dummies(\n    df[cat_cols].astype(str).apply(lambda s: s.str.strip()),\n    drop_first=False, dtype=int\n)\n\nscaler = StandardScaler()\nX_num = df[num_cols].copy()\nX_num[num_cols] = scaler.fit_transform(X_num[num_cols])\n\nX = pd.concat([X_num, X_cat], axis=1).values\ny_map = {\"h\": 0, \"d\": 1, \"a\": 2}\ny = df[target].astype(str).str.strip().map(y_map).astype(int).values\n\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42, stratify=y\n)\n\npca = PCA(n_components=2)\nX_train_pca = pca.fit_transform(X_train)\n\nkmeans = KMeans(n_clusters=3, init=\"k-means++\", max_iter=300, n_init=10, random_state=42)\nlabels = kmeans.fit_predict(X_train_pca)\n\ncluster_map = {}\nclasses = np.unique(y_train)\nfor c in np.unique(labels):\n    mask = labels == c\n    if mask.sum() == 0:\n        cluster_map[c] = classes[0]\n        continue\n    counts = np.bincount(y_train[mask], minlength=classes.max()+1)\n    majority = counts.argmax()\n    cluster_map[c] = majority\n\ny_pred_train = np.array([cluster_map[c] for c in labels])\nacc = accuracy_score(y_train, y_pred_train)\ncm = confusion_matrix(y_train, y_pred_train, labels=np.sort(classes))\n\ncm_df = pd.DataFrame(\n    cm,\n    index=[f\"Classe Real {cls}\" for cls in np.sort(classes)],\n    columns=[f\"Classe Pred {cls}\" for cls in np.sort(classes)]\n)\n\nprint(f\"Acur\u00e1cia: {acc*100:.2f}%\")\nprint(\"&lt;br&gt;Matriz de Confus\u00e3o:\")\nprint(cm_df.to_html(index=True))\n</code></pre> <p>As observa\u00e7\u00f5es principais s\u00e3o:</p> <ul> <li>O algoritmo conseguiu capturar alguns padr\u00f5es nas vit\u00f3rias do mandante (Classe 0) e visitante (Classe 2), mas ainda houve bastante confus\u00e3o entre elas.  </li> <li>A classe de empate (Classe 1) foi a mais dif\u00edcil de identificar, refletindo sua baixa frequ\u00eancia no dataset e a sobreposi\u00e7\u00e3o natural entre vari\u00e1veis.  </li> <li>A visualiza\u00e7\u00e3o em 2D refor\u00e7a essa dificuldade, mostrando que as fronteiras entre grupos s\u00e3o pouco definidas.</li> </ul>"},{"location":"k-means/main/#relatorio-final","title":"Relat\u00f3rio Final","text":"<p>O experimento com K-Means evidenciou os desafios de aplicar t\u00e9cnicas n\u00e3o supervisionadas no dom\u00ednio esportivo:  </p> <ul> <li>Explora\u00e7\u00e3o: foram utilizadas vari\u00e1veis contextuais (est\u00e1dio, p\u00fablico) e estat\u00edsticas gerais (posse, passes, chances), previamente normalizadas e transformadas em num\u00e9ricas.  </li> <li>Treinamento: o K-Means gerou 3 clusters, interpretados como padr\u00f5es de desempenho relacionados ao resultado da partida.  </li> <li>Avalia\u00e7\u00e3o: ao comparar clusters com classes reais, a acur\u00e1cia foi de ~47.9%, valor semelhante aos modelos supervisionados, mas com maiores limita\u00e7\u00f5es na interpreta\u00e7\u00e3o.  </li> </ul> <p>Alguns pontos importantes emergem da an\u00e1lise: - O K-Means n\u00e3o tem acesso direto \u00e0s classes, e portanto os agrupamentos n\u00e3o correspondem necessariamente a vit\u00f3rias, empates ou derrotas. - A sobreposi\u00e7\u00e3o natural dos dados mostra que estat\u00edsticas gerais de jogo n\u00e3o s\u00e3o suficientes para definir fronteiras claras entre resultados. - O futebol continua sendo altamente imprevis\u00edvel, com vari\u00e1veis externas (clima, arbitragem, forma dos jogadores, estrat\u00e9gia) que n\u00e3o est\u00e3o refletidas na base.  </p>"},{"location":"k-means/main/#conclusao","title":"Conclus\u00e3o","text":"<p>O uso do K-Means neste projeto demonstrou o potencial dos algoritmos n\u00e3o supervisionados para explorar padr\u00f5es em conjuntos de dados complexos, mas tamb\u00e9m refor\u00e7ou suas limita\u00e7\u00f5es frente a tarefas de previs\u00e3o. A acur\u00e1cia de ~47.9% mostra que, mesmo quando os clusters s\u00e3o posteriormente relacionados \u00e0s classes reais, o modelo n\u00e3o consegue separar bem as situa\u00e7\u00f5es de vit\u00f3ria, empate e derrota.  </p> <p>Assim como nos experimentos anteriores, o aprendizado principal n\u00e3o est\u00e1 apenas no valor num\u00e9rico da m\u00e9trica, mas no entendimento de que nem todo fen\u00f4meno pode ser descrito por padr\u00f5es lineares ou consistentes. Esse resultado abre espa\u00e7o para trabalhos futuros, como o uso de modelos h\u00edbridos (combinando supervisionados e n\u00e3o supervisionados) ou a incorpora\u00e7\u00e3o de vari\u00e1veis mais ricas, como desempenho de jogadores, estat\u00edsticas avan\u00e7adas e fatores contextuais adicionais.</p>"},{"location":"knn/main/","title":"KNN","text":""},{"location":"knn/main/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo desta etapa foi aplicar o algoritmo K-Nearest Neighbors (KNN) sobre a base de dados de partidas de futebol, utilizando as bibliotecas <code>pandas</code>, <code>numpy</code>, <code>matplotlib</code> e <code>scikit-learn</code>. Diferente da \u00e1rvore de decis\u00e3o, o KNN classifica novas observa\u00e7\u00f5es com base na proximidade de exemplos j\u00e1 conhecidos. A proposta \u00e9 avaliar como vari\u00e1veis como est\u00e1dio, p\u00fablico, posse de bola, passes e chances criadas podem auxiliar na previs\u00e3o do resultado da partida (<code>class</code>). Foram desenvolvidas duas abordagens: uma implementa\u00e7\u00e3o manual, para consolidar a compreens\u00e3o do funcionamento do m\u00e9todo, e outra com a biblioteca scikit-learn, permitindo compara\u00e7\u00e3o de resultados e visualiza\u00e7\u00e3o da fronteira de decis\u00e3o por meio do PCA.</p>"},{"location":"knn/main/#base-de-dados","title":"Base de dados","text":"<p>A base de dados utilizada neste projeto cont\u00e9m informa\u00e7\u00f5es de partidas de futebol, totalizando 1140 linhas e 40 colunas. Entre as vari\u00e1veis est\u00e3o posse de bola, n\u00famero de passes e chances criadas. A vari\u00e1vel alvo escolhida \u00e9 a coluna <code>class</code>, que indica o resultado da partida (vit\u00f3ria do mandante, empate ou vit\u00f3ria do visitante).</p>"},{"location":"knn/main/#exploracao-dos-dados","title":"Explora\u00e7\u00e3o dos Dados","text":"<p>A seguir foi feita uma an\u00e1lise do significado e composi\u00e7\u00e3o de cada coluna presente na base, com a finalidade de identificar poss\u00edveis problemas a serem tratados posteriormente. As visualiza\u00e7\u00f5es e estat\u00edsticas descritivas ajudam a compreender a natureza dos dados e orientar decis\u00f5es de pr\u00e9-processamento e modelagem.</p> classattendancestadiumhome_possessionsaway_possessionsHome TeamAway Teamhome_passaway_passhome_chancesaway_chances <p>A coluna <code>class</code> \u00e9 a vari\u00e1vel alvo do projeto e representa o resultado da partida: vit\u00f3ria do mandante (\"h\"), empate (\"d\") ou vit\u00f3ria do visitante (\"a\").  Trata-se de uma vari\u00e1vel categ\u00f3rica com tr\u00eas poss\u00edveis valores, sendo o objeto de classifica\u00e7\u00e3o do modelo de \u00e1rvore de decis\u00e3o.  A an\u00e1lise explorat\u00f3ria dessa coluna \u00e9 essencial para observar o balanceamento do conjunto de dados, isto \u00e9, se h\u00e1 propor\u00e7\u00f5es semelhantes ou discrepantes entre os resultados poss\u00edveis.</p> 2025-12-09T12:44:38.058561 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>attendance</code> representa o p\u00fablico presente em cada partida, um indicador de contexto do jogo que pode refletir fatores como mando de campo, relev\u00e2ncia do confronto e engajamento da torcida. Em bases de futebol, o p\u00fablico tende a variar bastante entre est\u00e1dios e rodadas, podendo apresentar assimetria (jogos muito cheios em arenas grandes) e valores at\u00edpicos (cl\u00e1ssicos, finais).</p> <p>Do ponto de vista anal\u00edtico, \u00e9 uma vari\u00e1vel cont\u00ednua \u00fatil para observar a distribui\u00e7\u00e3o de torcedores ao longo das partidas e investigar rela\u00e7\u00f5es com o resultado (<code>class</code>).</p> 2025-12-09T12:44:38.132869 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>stadium</code> identifica o est\u00e1dio onde a partida foi disputada. Trata-se de uma vari\u00e1vel categ\u00f3rica, associada ao contexto e \u00e0 capacidade do local, podendo refletir fatores como mando de campo, perfil da torcida, relevo do gramado e at\u00e9 particularidades log\u00edsticas.  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por est\u00e1dio, verificando balanceamento da amostra (quais arenas t\u00eam mais/menos partidas) e poss\u00edveis vieses (ex.: concentra\u00e7\u00e3o em poucos est\u00e1dios).  Rela\u00e7\u00f5es mais profundas com o resultado (<code>class</code>) podem ser investigadas em etapas seguintes, mas aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel no conjunto de dados.</p> 2025-12-09T12:44:38.328141 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_possessions</code> representa a porcentagem de posse de bola do time mandante em cada partida.  Trata-se de uma vari\u00e1vel num\u00e9rica cont\u00ednua, normalmente variando entre 30% e 70% na maioria dos jogos, podendo indicar estilos de jogo (times que mant\u00eam a bola ou que jogam mais reativamente).  A an\u00e1lise explorat\u00f3ria dessa vari\u00e1vel permite observar a distribui\u00e7\u00e3o da posse de bola entre os mandantes, identificar valores at\u00edpicos e comparar a m\u00e9dia do controle de jogo ao longo das rodadas.  Posteriormente, poder\u00e1 ser interessante relacionar essa posse com o resultado final (<code>class</code>) para verificar padr\u00f5es.</p> 2025-12-09T12:44:38.510538 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_possessions</code> representa a porcentagem de posse de bola do time visitante em cada partida.  Por ser uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o ajuda a observar o comportamento dos visitantes em termos de controle de jogo, identificar valores at\u00edpicos e comparar a tend\u00eancia m\u00e9dia de posse fora de casa.  Em etapas posteriores, pode ser relacionada ao resultado (<code>class</code>) para investigar padr\u00f5es de desempenho como visitante.</p> 2025-12-09T12:44:38.644035 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Home Team</code> identifica o time mandante na partida. Embora esteja codificada numericamente no dataset, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por mandante, verificando o balanceamento da amostra entre os times que atuam em casa e poss\u00edveis concentra\u00e7\u00f5es.  Rela\u00e7\u00f5es com o resultado (<code>class</code>) podem ser exploradas depois; aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel.</p> 2025-12-09T12:44:38.804403 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Away Team</code> identifica o time visitante na partida. Apesar de codificada como n\u00famero, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, observar a frequ\u00eancia de jogos por visitante ajuda a avaliar o balanceamento da amostra e poss\u00edveis concentra\u00e7\u00f5es de partidas em determinados clubes.</p> 2025-12-09T12:44:38.991084 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_pass</code> indica o n\u00famero de passes realizados pelo time mandante em cada partida.  \u00c9 uma vari\u00e1vel num\u00e9rica cont\u00ednua que ajuda a caracterizar o estilo de jogo do mandante, podendo variar bastante entre equipes mais ou menos dependentes da posse de bola.  Na an\u00e1lise explorat\u00f3ria, observar a distribui\u00e7\u00e3o dos passes permite identificar m\u00e9dias, dispers\u00e3o e valores at\u00edpicos.</p> 2025-12-09T12:44:39.149154 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_pass</code> indica o n\u00famero de passes realizados pelo time visitante em cada partida.  Sendo uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o mostra como os visitantes se comportam em termos de constru\u00e7\u00e3o de jogadas e controle de posse fora de casa.  A an\u00e1lise explorat\u00f3ria ajuda a entender a m\u00e9dia de passes, varia\u00e7\u00f5es entre os jogos e eventuais valores extremos.</p> 2025-12-09T12:44:39.279274 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_chances</code> representa a quantidade de chances de gol criadas pelo time mandante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que indica o n\u00edvel de ofensividade da equipe jogando em casa.  A an\u00e1lise explorat\u00f3ria permite identificar a frequ\u00eancia de jogos com poucas ou muitas oportunidades e verificar a dispers\u00e3o desse tipo de estat\u00edstica.</p> 2025-12-09T12:44:39.413621 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_chances</code> indica a quantidade de chances de gol criadas pelo time visitante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que ajuda a compreender a ofensividade dos times jogando fora de casa.  A an\u00e1lise explorat\u00f3ria mostra como os visitantes se comportam em termos de cria\u00e7\u00e3o de oportunidades, permitindo identificar padr\u00f5es de equil\u00edbrio ou diferen\u00e7as marcantes em rela\u00e7\u00e3o aos mandantes.</p> 2025-12-09T12:44:39.548807 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/"},{"location":"knn/main/#pre-processamento","title":"Pr\u00e9-processamento","text":"<p>Ap\u00f3s a explora\u00e7\u00e3o inicial da base, foram aplicados procedimentos de pr\u00e9-processamento para preparar os dados para o treinamento do modelo. Entre as etapas realizadas est\u00e3o:</p> <ul> <li>Convers\u00e3o de tipos: vari\u00e1veis originalmente em texto com valores num\u00e9ricos (como <code>attendance</code>) foram transformadas em formato num\u00e9rico.  </li> <li>Tratamento de valores categ\u00f3ricos: colunas como <code>stadium</code>, <code>Home Team</code> e <code>Away Team</code> foram mantidas como categ\u00f3ricas, sendo posteriormente convertidas em vari\u00e1veis num\u00e9ricas por meio de t\u00e9cnicas de codifica\u00e7\u00e3o.  </li> <li>Remo\u00e7\u00e3o de colunas irrelevantes ou redundantes: colunas de identifica\u00e7\u00e3o e de tempo (<code>date</code>, <code>clock</code>, <code>links</code>), bem como estat\u00edsticas que representam vazamento de informa\u00e7\u00e3o do resultado (ex.: <code>Goals Home</code>, <code>Away Goals</code>), foram descartadas do conjunto de treino.  </li> <li>Separa\u00e7\u00e3o entre features e target: as vari\u00e1veis explicativas (<code>X</code>) foram definidas a partir de aproximadamente dez colunas relevantes da base, enquanto a vari\u00e1vel alvo (<code>y</code>) \u00e9 a coluna <code>class</code>.  </li> <li>Divis\u00e3o em treino e teste: o conjunto de dados foi dividido em duas partes, garantindo estratifica\u00e7\u00e3o do alvo para manter o equil\u00edbrio das classes.</li> </ul> Base preparadacodeBase original stadium class attendance Home Team Away Team home_possessions away_possessions home_pass away_pass home_chances away_chances 17 0 40020 12 8 64.6 35.4 86.8 78.3 1 0 13 1 73084 3 20 52.3 47.7 81.4 80.7 4 1 16 0 30139 20 18 34.9 65.1 68.8 79 0 3 14 1 25043 11 9 48.9 51.1 81.1 80.1 0 5 6 1 0 19 2 66.3 33.7 85 70.9 2 1 9 0 0 17 20 46.6 53.4 74.6 77.5 2 1 13 0 0 3 6 57.7 42.3 84.4 77.1 4 2 3 2 0 25 2 45.1 54.9 84.6 89.1 0 2 2 0 53275 5 8 67.6 32.4 88.3 73.7 2 4 20 1 31298 18 11 53.1 46.9 85.1 82.9 1 0 14 1 24827 11 6 25.8 74.2 70.4 89.9 0 5 <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\nprint(df.sample(frac=.01).to_markdown(index=False))\n</code></pre> date clock stadium class attendance Home Team Goals Home Away Team Away Goals home_possessions away_possessions home_shots away_shots home_on away_on home_off away_off home_blocked away_blocked home_pass away_pass home_chances away_chances home_corners away_corners home_offside away_offside home_tackles away_tackles home_duels away_duels home_saves away_saves home_fouls away_fouls home_yellow away_yellow home_red away_red links 7/2/2021 12:00pm 8 Stadium h 0 8 2 24 0 65.6 34.4 13 4 6 1 4 3 3 0 86.1 71.9 2 1 8 0 1 4 58.8 58.3 35.9 64.1 1 4 16 12 1 2 0 0 https://www.skysports.com/football/tottenham-hotspur-vs-west-bromwich-albion/stats/429065 20th August 2022 3:00pm Goodison Park d 39,271 17 1 16 1 48.3 51.7 19 14 8 5 6 6 5 3 77.4 73.4 1 0 6 2 4 1 61.5 77.3 40 60 4 7 6 9 3 2 0 0 https://www.skysports.com/football/everton-vs-nottingham-forest/464657 16/01/2021 3:00pm London Stadium h 0 14 1 23 0 44.8 55.2 15 10 4 2 6 3 5 5 72.8 73.8 0 0 7 4 5 1 62.5 46.2 54.4 45.6 2 2 12 9 2 1 0 0 https://www.skysports.com/football/west-ham-united-vs-burnley/stats/429025 17th September 2022 5:30pm Tottenham Hotspur Stadium h 61,450 8 6 18 2 43.7 56.3 16 19 11 7 2 7 3 5 83.6 87.3 2 1 6 1 1 0 28.6 75 54.5 45.5 5 5 9 9 1 2 0 0 https://www.skysports.com/football/tottenham-hotspur-vs-leicester-city/464713 26/9/2020 5:30pm The Hawthorns d 0 24 3 12 3 24.1 75.9 9 22 3 10 4 6 2 6 67.5 89.2 1 2 3 9 1 0 44.4 75 41.4 58.6 7 0 8 16 1 3 0 0 https://www.skysports.com/football/west-bromwich-albion-vs-chelsea/stats/428865 15th December 2021 7:30pm Selhurst Park d 22,861 11 2 20 2 59.7 40.3 9 15 6 4 2 7 1 4 74.3 64.5 2 0 4 6 1 3 50 83.3 52.2 47.8 2 4 16 20 2 4 0 0 https://www.skysports.com/football/crystal-palace-vs-southampton/stats/446452 26/12/2020 8:00pm Bramall Lane a 0 25 0 17 1 43.8 56.2 10 7 2 3 5 3 3 1 72.9 79.1 1 1 6 3 0 2 50 76.9 38.8 61.2 2 1 11 10 2 4 0 0 https://www.skysports.com/football/sheffield-united-vs-everton/stats/428984 24th October 2022 8:00pm London Stadium h 62,447 14 2 15 0 54.4 45.6 20 5 4 3 8 2 8 0 84.7 83.1 1 1 5 0 1 0 45.5 76.2 48.6 51.4 3 2 9 11 0 2 0 0 https://www.skysports.com/football/west-ham-united-vs-bournemouth/464763 21st November 2021 2:00pm Etihad Stadium h 52,571 1 3 17 0 73.3 22.7 17 4 7 1 6 0 4 3 93.7 69.6 4 0 7 1 0 2 46.7 38.9 75 25 1 4 5 7 1 1 0 0 https://www.skysports.com/football/manchester-city-vs-everton/stats/446402 28th August 2021 5:30pm Anfield d 53,100 5 1 12 1 65.7 34.3 24 6 7 3 12 1 5 2 86 72.4 2 0 12 3 0 2 56.3 46.2 61.8 38.2 2 6 13 4 0 2 0 1 https://www.skysports.com/football/liverpool-vs-chelsea/stats/446311 27th November 2021 3:00pm Anfield h 53,040 5 4 20 0 64.5 35.5 20 7 6 3 9 1 5 3 80.3 68.3 3 1 5 7 2 2 76.9 37.5 41.2 58.8 3 2 7 14 0 1 0 0 https://www.skysports.com/football/liverpool-vs-southampton/stats/446415"},{"location":"knn/main/#divisao-dos-dados","title":"Divis\u00e3o dos Dados","text":"<p>Com a base pr\u00e9-processada, realizou-se a divis\u00e3o entre conjuntos de treinamento e teste. O objetivo dessa etapa \u00e9 garantir que o modelo seja avaliado em dados que ele nunca viu durante o treinamento, permitindo uma medida mais confi\u00e1vel de sua capacidade de generaliza\u00e7\u00e3o.  </p> <p>Foi utilizada a fun\u00e7\u00e3o <code>train_test_split</code> da biblioteca scikit-learn, com os seguintes crit\u00e9rios: - 70% dos dados destinados ao treinamento, para que o modelo aprenda os padr\u00f5es da base; - 30% dos dados destinados ao teste, para avaliar o desempenho em novos exemplos; - Estratifica\u00e7\u00e3o pelo alvo (<code>class</code>), garantindo que a propor\u00e7\u00e3o entre vit\u00f3rias do mandante, empates e vit\u00f3rias do visitante fosse mantida em ambos os conjuntos; - Random State fixado, assegurando reprodutibilidade na divis\u00e3o.  </p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\n# Vari\u00e1veis independentes (features)\nx = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]]\n\n# Vari\u00e1vel dependente (alvo)\ny = df[\"class\"]\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=27, stratify=y)\n</code></pre>"},{"location":"knn/main/#treinamento-do-modelo","title":"Treinamento do Modelo","text":"<p>Nesta se\u00e7\u00e3o foi implementado o algoritmo KNN de forma manual, a partir do zero, para consolidar o entendimento do funcionamento do m\u00e9todo. A implementa\u00e7\u00e3o considera a dist\u00e2ncia euclidiana entre os pontos, identifica os vizinhos mais pr\u00f3ximos e atribui a classe com maior frequ\u00eancia. Esse exerc\u00edcio \u00e9 importante para compreender a l\u00f3gica por tr\u00e1s do KNN antes de utilizar bibliotecas prontas.</p> ModeloC\u00f3digo <p>Acur\u00e1cia (KNN k=5): 0.51 </p> <pre><code>import numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.preprocessing import StandardScaler\n\nDATA_PATH = \"./src/mydata.csv\"\ndf = pd.read_csv(DATA_PATH)\n\ny_map = {\"h\": 0, \"d\": 1, \"a\": 2}\ny = df[\"class\"].astype(str).str.strip().map(y_map).astype(int)\n\nnum_cols = [\n    \"attendance\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\",\n]\ncat_cols = [\"stadium\", \"Home Team\", \"Away Team\"]\n\ndf[\"attendance\"] = (\n    df[\"attendance\"]\n      .astype(str)\n      .str.replace(r\"[^0-9]\", \"\", regex=True)\n      .replace(\"\", \"0\")\n      .astype(float)\n)\n\nfor c in num_cols:\n    df[c] = pd.to_numeric(df[c], errors=\"coerce\")\n    df[c] = df[c].fillna(df[c].median())\n\nX_cat = pd.get_dummies(\n    df[cat_cols].astype(str).apply(lambda s: s.str.strip()),\n    drop_first=False, dtype=int\n)\nX_num = df[num_cols].copy()\n\nscaler = StandardScaler()\nX_num[num_cols] = scaler.fit_transform(X_num[num_cols])\n\nX = pd.concat([X_num, X_cat], axis=1).values\n\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.20, random_state=42, stratify=y\n)\n\nclass KNNClassifier:\n    def __init__(self, k=5):\n        self.k = k\n\n    def fit(self, X, y):\n        self.X_train = X\n        self.y_train = np.array(y)\n\n    def predict(self, X):\n        return np.array([self._predict(x) for x in X])\n\n    def _predict(self, x):\n        distances = np.sqrt(((self.X_train - x) ** 2).sum(axis=1))\n        k_idx = np.argsort(distances)[:self.k]\n        k_labels = self.y_train[k_idx]\n        vals, counts = np.unique(k_labels, return_counts=True)\n        return vals[np.argmax(counts)]\n\nknn = KNNClassifier(k=5)\nknn.fit(X_train, y_train)\ny_pred = knn.predict(X_test)\n\nacc = accuracy_score(y_test, y_pred)\nprint(f\"Acur\u00e1cia (KNN k={knn.k}): {acc:.2f}\")\n</code></pre>"},{"location":"knn/main/#usando-scikit-learn","title":"Usando Scikit-Learn","text":"<p>Nesta se\u00e7\u00e3o foi implementado o algoritmo KNN de forma manual, a partir do zero, para consolidar o entendimento do funcionamento do m\u00e9todo. A implementa\u00e7\u00e3o considera a dist\u00e2ncia euclidiana entre os pontos, identifica os vizinhos mais pr\u00f3ximos e atribui a classe com maior frequ\u00eancia. Esse exerc\u00edcio \u00e9 importante para compreender a l\u00f3gica por tr\u00e1s do KNN antes de utilizar bibliotecas prontas.</p> ResultadoC\u00f3digo <p>Accuracy: 0.42  2025-12-09T12:44:39.970931 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ </p> <pre><code>import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\n\n# 1) Carregar sua base\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# 2) Alvo (class): h=mandante, d=empate, a=visitante\ny_map = {\"h\": 0, \"d\": 1, \"a\": 2}\ny = df[\"class\"].astype(str).str.strip().map(y_map).astype(int)\n\n# 3) Sele\u00e7\u00e3o de features (\u224810, sem vazamento)\nnum_cols = [\n    \"attendance\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\",\n]\ncat_cols = [\"stadium\", \"Home Team\", \"Away Team\"]\n\n# 4) Limpezas m\u00ednimas para num\u00e9ricas (ex.: attendance vem como texto com pontua\u00e7\u00e3o)\ndf[\"attendance\"] = (\n    df[\"attendance\"]\n      .astype(str)\n      .str.replace(r\"[^0-9]\", \"\", regex=True)\n      .replace(\"\", \"0\")\n      .astype(float)\n)\n\nfor c in num_cols:\n    df[c] = pd.to_numeric(df[c], errors=\"coerce\")\n    df[c] = df[c].fillna(df[c].median())\n\n# 5) One-hot para categ\u00f3ricas; escala para num\u00e9ricas\nX_cat = pd.get_dummies(\n    df[cat_cols].astype(str).apply(lambda s: s.str.strip()),\n    drop_first=False, dtype=int\n)\nX_num = df[num_cols].copy()\n\nscaler = StandardScaler()\nX_num[num_cols] = scaler.fit_transform(X_num[num_cols])\n\nX = pd.concat([X_num, X_cat], axis=1).values\n\n# 6) Split (mesma estrutura)\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42, stratify=y\n)\n\n# 7) PCA s\u00f3 para visualiza\u00e7\u00e3o (2D)\npca = PCA(n_components=2)\nX_train_2d = pca.fit_transform(X_train)\nX_test_2d = pca.transform(X_test)\n\n# 8) KNN (baseline igual)\nknn = KNeighborsClassifier(n_neighbors=5)\nknn.fit(X_train_2d, y_train)\npredictions = knn.predict(X_test_2d)\nprint(f\"Accuracy: {accuracy_score(y_test, predictions):.2f}\")\n\n# 9) Fronteira de decis\u00e3o (no espa\u00e7o 2D do PCA)\nplt.figure(figsize=(12, 10))\nh = 0.05\nx_min, x_max = X_train_2d[:, 0].min() - 1, X_train_2d[:, 0].max() + 1\ny_min, y_max = X_train_2d[:, 1].min() - 1, X_train_2d[:, 1].max() + 1\nxx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))\n\nZ = knn.predict(np.c_[xx.ravel(), yy.ravel()])\nZ = Z.reshape(xx.shape)\n\nplt.contourf(xx, yy, Z, cmap=plt.cm.RdYlBu, alpha=0.3)\nsns.scatterplot(x=X_train_2d[:, 0], y=X_train_2d[:, 1], hue=y_train,\n                palette=\"deep\", s=100, edgecolor=\"k\", alpha=0.8, legend=\"full\")\n\nplt.xlabel(\"PCA 1\")\nplt.ylabel(\"PCA 2\")\nplt.title(\"KNN Decision Boundary (Football Matches)\")\n\nbuffer = StringIO()\nplt.savefig(buffer, format=\"svg\", transparent=True)\nprint(buffer.getvalue())\n</code></pre>"},{"location":"knn/main/#avaliacao-do-modelo","title":"Avalia\u00e7\u00e3o do Modelo","text":"<p>Ap\u00f3s o treinamento do algoritmo KNN, o modelo foi avaliado no conjunto de teste, obtendo resultados de acur\u00e1cia em torno de 0.42 (usando scikit-learn) e 0.51 (na implementa\u00e7\u00e3o manual). Esses valores mostram que o modelo consegue acertar parte das previs\u00f5es, mas ainda apresenta uma performance limitada.  </p> <p>Esse resultado deve ser interpretado considerando a natureza do problema: prever o resultado de uma partida de futebol \u00e9 uma tarefa complexa, com alto grau de incerteza. Mesmo dispondo de estat\u00edsticas como posse de bola, passes, chances criadas, est\u00e1dio e p\u00fablico, o desfecho de um jogo depende tamb\u00e9m de fatores externos como arbitragem, les\u00f5es, clima, motiva\u00e7\u00e3o e at\u00e9 elementos de acaso. Portanto, ainda que houvesse mais dados dispon\u00edveis, a previs\u00e3o exata continuaria sendo incerta.  </p> <p>A figura abaixo mostra a fronteira de decis\u00e3o do KNN no espa\u00e7o bidimensional reduzido pelo PCA. As regi\u00f5es coloridas representam as \u00e1reas de influ\u00eancia de cada classe, enquanto os pontos correspondem \u00e0s partidas reais.</p> <p>\u00c9 poss\u00edvel observar uma forte sobreposi\u00e7\u00e3o entre classes, com pontos de diferentes resultados distribu\u00eddos de forma bastante misturada. Isso refor\u00e7a as limita\u00e7\u00f5es do modelo:</p> <ul> <li>Baixa capacidade preditiva: as vari\u00e1veis utilizadas ajudam a descrever o contexto, mas n\u00e3o criam fronteiras claras para separar vit\u00f3rias, empates e derrotas.  </li> <li>Balanceamento do alvo: os empates, menos frequentes, tendem a ser mal classificados, prejudicando a acur\u00e1cia global.  </li> <li>Sensibilidade do algoritmo: o KNN depende fortemente da escala, da escolha de <code>k</code> e da representa\u00e7\u00e3o dos dados, o que gera varia\u00e7\u00f5es nos resultados.  </li> <li>Complexidade do dom\u00ednio: a imprevisibilidade do futebol limita naturalmente a precis\u00e3o que qualquer modelo pode alcan\u00e7ar.  </li> </ul> <p>Portanto, as acur\u00e1cias obtidas refletem tanto as limita\u00e7\u00f5es do KNN quanto a complexidade do fen\u00f4meno esportivo. Mais do que \u201cacertar resultados\u201d, o exerc\u00edcio evidencia os desafios de aplicar Machine Learning em cen\u00e1rios reais de alta incerteza.</p>"},{"location":"knn/main/#relatorio-final","title":"Relat\u00f3rio Final","text":"<p>O projeto teve como objetivo aplicar o algoritmo KNN sobre uma base de partidas de futebol, explorando seu potencial no contexto esportivo.  </p> <p>A an\u00e1lise foi conduzida em etapas bem definidas:</p> <ul> <li>Explora\u00e7\u00e3o dos Dados (EDA): foram selecionadas e analisadas cerca de dez vari\u00e1veis relevantes, incluindo <code>stadium</code>, <code>attendance</code>, <code>Home Team</code>, <code>Away Team</code>, <code>home_possessions</code>, <code>away_possessions</code>, <code>home_pass</code>, <code>away_pass</code>, <code>home_chances</code> e <code>away_chances</code>.  </li> <li>Pr\u00e9-processamento: colunas irrelevantes (como IDs e dados de tempo) e estat\u00edsticas ligadas diretamente ao resultado (como gols) foram removidas. Vari\u00e1veis categ\u00f3ricas foram transformadas em num\u00e9ricas via One-Hot Encoding e vari\u00e1veis cont\u00ednuas foram padronizadas.  </li> <li>Divis\u00e3o dos Dados: o conjunto foi separado em treino (70%) e teste (30%), preservando a propor\u00e7\u00e3o entre vit\u00f3rias, empates e derrotas atrav\u00e9s da estratifica\u00e7\u00e3o.  </li> <li>Treinamento e Avalia\u00e7\u00e3o: o KNN foi aplicado em duas vers\u00f5es \u2014 manual e com scikit-learn \u2014 alcan\u00e7ando acur\u00e1cias de 0.42\u20130.51, valores que evidenciam desempenho limitado, mas condizente com a natureza do problema.  </li> </ul> <p>A avalia\u00e7\u00e3o trouxe alguns aprendizados importantes: - O KNN \u00e9 sens\u00edvel \u00e0 prepara\u00e7\u00e3o dos dados e \u00e0 escolha de hiperpar\u00e2metros, o que explica diferen\u00e7as entre implementa\u00e7\u00f5es. - As vari\u00e1veis utilizadas caracterizam parcialmente os jogos, mas n\u00e3o s\u00e3o suficientes para prever com exatid\u00e3o seus resultados. - A visualiza\u00e7\u00e3o da fronteira de decis\u00e3o mostrou que as classes apresentam alta sobreposi\u00e7\u00e3o, o que dificulta a separa\u00e7\u00e3o clara. - O futebol, por ser um evento com forte componente de imprevisibilidade, imp\u00f5e limites naturais ao desempenho de qualquer modelo.  </p>"},{"location":"knn/main/#conclusao","title":"Conclus\u00e3o","text":"<p>Assim como na \u00e1rvore de decis\u00e3o, a experi\u00eancia com o KNN refor\u00e7a a import\u00e2ncia de interpretar os resultados com cautela. A acur\u00e1cia pr\u00f3xima de 0.5 n\u00e3o deve ser vista apenas como limita\u00e7\u00e3o do algoritmo, mas como reflexo da complexidade do dom\u00ednio esportivo.  </p> <p>O projeto destacou a relev\u00e2ncia da an\u00e1lise explorat\u00f3ria, do cuidado com o pr\u00e9-processamento e da avalia\u00e7\u00e3o cr\u00edtica dos modelos. Al\u00e9m disso, abre espa\u00e7o para trabalhos futuros que explorem vari\u00e1veis adicionais (desempenho hist\u00f3rico dos times, estat\u00edsticas de jogadores, forma recente, fatores externos) e ajustes de hiperpar\u00e2metros do KNN para buscar melhorias.  </p> <p>Mais do que prever com exatid\u00e3o, este trabalho evidencia o potencial e os limites do uso de algoritmos de aprendizado de m\u00e1quina em contextos reais, nos quais a incerteza \u00e9 parte inerente do fen\u00f4meno analisado.</p>"},{"location":"random-forest/main/","title":"Random Forest","text":""},{"location":"random-forest/main/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>Aplicar Random Forest para prever o resultado de partidas da Premier League (<code>class</code>: 0=mandante, 1=empate, 2=visitante) usando as ~10 vari\u00e1veis j\u00e1 utilizadas nos modelos anteriores (est\u00e1dio, p\u00fablico, posse, passes, chances e IDs dos times). Mantivemos o mesmo padr\u00e3o do projeto: remo\u00e7\u00e3o de colunas com vazamento, limpeza de tipos (ex.: <code>attendance</code>), estratifica\u00e7\u00e3o na divis\u00e3o 70/30 e sem usar estat\u00edsticas de gols.</p>"},{"location":"random-forest/main/#base-de-dados","title":"Base de dados","text":"<p>A base de dados utilizada neste projeto cont\u00e9m informa\u00e7\u00f5es de partidas de futebol, totalizando 1140 linhas e 40 colunas. Entre as vari\u00e1veis est\u00e3o posse de bola, n\u00famero de passes e chances criadas. A vari\u00e1vel alvo escolhida \u00e9 a coluna <code>class</code>, que indica o resultado da partida (vit\u00f3ria do mandante, empate ou vit\u00f3ria do visitante).</p>"},{"location":"random-forest/main/#exploracao-dos-dados","title":"Explora\u00e7\u00e3o dos Dados","text":"<p>A seguir foi feita uma an\u00e1lise do significado e composi\u00e7\u00e3o de cada coluna presente na base, com a finalidade de identificar poss\u00edveis problemas a serem tratados posteriormente. As visualiza\u00e7\u00f5es e estat\u00edsticas descritivas ajudam a compreender a natureza dos dados e orientar decis\u00f5es de pr\u00e9-processamento e modelagem.</p> classattendancestadiumhome_possessionsaway_possessionsHome TeamAway Teamhome_passaway_passhome_chancesaway_chances <p>A coluna <code>class</code> \u00e9 a vari\u00e1vel alvo do projeto e representa o resultado da partida: vit\u00f3ria do mandante (\"h\"), empate (\"d\") ou vit\u00f3ria do visitante (\"a\").  Trata-se de uma vari\u00e1vel categ\u00f3rica com tr\u00eas poss\u00edveis valores, sendo o objeto de classifica\u00e7\u00e3o do modelo de \u00e1rvore de decis\u00e3o.  A an\u00e1lise explorat\u00f3ria dessa coluna \u00e9 essencial para observar o balanceamento do conjunto de dados, isto \u00e9, se h\u00e1 propor\u00e7\u00f5es semelhantes ou discrepantes entre os resultados poss\u00edveis.</p> 2025-12-09T12:44:40.435730 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>attendance</code> representa o p\u00fablico presente em cada partida, um indicador de contexto do jogo que pode refletir fatores como mando de campo, relev\u00e2ncia do confronto e engajamento da torcida. Em bases de futebol, o p\u00fablico tende a variar bastante entre est\u00e1dios e rodadas, podendo apresentar assimetria (jogos muito cheios em arenas grandes) e valores at\u00edpicos (cl\u00e1ssicos, finais).</p> <p>Do ponto de vista anal\u00edtico, \u00e9 uma vari\u00e1vel cont\u00ednua \u00fatil para observar a distribui\u00e7\u00e3o de torcedores ao longo das partidas e investigar rela\u00e7\u00f5es com o resultado (<code>class</code>).</p> 2025-12-09T12:44:40.505674 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>stadium</code> identifica o est\u00e1dio onde a partida foi disputada. Trata-se de uma vari\u00e1vel categ\u00f3rica, associada ao contexto e \u00e0 capacidade do local, podendo refletir fatores como mando de campo, perfil da torcida, relevo do gramado e at\u00e9 particularidades log\u00edsticas.  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por est\u00e1dio, verificando balanceamento da amostra (quais arenas t\u00eam mais/menos partidas) e poss\u00edveis vieses (ex.: concentra\u00e7\u00e3o em poucos est\u00e1dios).  Rela\u00e7\u00f5es mais profundas com o resultado (<code>class</code>) podem ser investigadas em etapas seguintes, mas aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel no conjunto de dados.</p> 2025-12-09T12:44:40.687948 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_possessions</code> representa a porcentagem de posse de bola do time mandante em cada partida.  Trata-se de uma vari\u00e1vel num\u00e9rica cont\u00ednua, normalmente variando entre 30% e 70% na maioria dos jogos, podendo indicar estilos de jogo (times que mant\u00eam a bola ou que jogam mais reativamente).  A an\u00e1lise explorat\u00f3ria dessa vari\u00e1vel permite observar a distribui\u00e7\u00e3o da posse de bola entre os mandantes, identificar valores at\u00edpicos e comparar a m\u00e9dia do controle de jogo ao longo das rodadas.  Posteriormente, poder\u00e1 ser interessante relacionar essa posse com o resultado final (<code>class</code>) para verificar padr\u00f5es.</p> 2025-12-09T12:44:40.866994 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_possessions</code> representa a porcentagem de posse de bola do time visitante em cada partida.  Por ser uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o ajuda a observar o comportamento dos visitantes em termos de controle de jogo, identificar valores at\u00edpicos e comparar a tend\u00eancia m\u00e9dia de posse fora de casa.  Em etapas posteriores, pode ser relacionada ao resultado (<code>class</code>) para investigar padr\u00f5es de desempenho como visitante.</p> 2025-12-09T12:44:41.000310 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Home Team</code> identifica o time mandante na partida. Embora esteja codificada numericamente no dataset, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, \u00e9 \u00fatil observar a frequ\u00eancia de jogos por mandante, verificando o balanceamento da amostra entre os times que atuam em casa e poss\u00edveis concentra\u00e7\u00f5es.  Rela\u00e7\u00f5es com o resultado (<code>class</code>) podem ser exploradas depois; aqui focamos em entender a composi\u00e7\u00e3o dessa vari\u00e1vel.</p> 2025-12-09T12:44:41.160373 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>Away Team</code> identifica o time visitante na partida. Apesar de codificada como n\u00famero, sua natureza \u00e9 categ\u00f3rica (IDs de times).  Na an\u00e1lise explorat\u00f3ria, observar a frequ\u00eancia de jogos por visitante ajuda a avaliar o balanceamento da amostra e poss\u00edveis concentra\u00e7\u00f5es de partidas em determinados clubes.</p> 2025-12-09T12:44:41.344710 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_pass</code> indica o n\u00famero de passes realizados pelo time mandante em cada partida.  \u00c9 uma vari\u00e1vel num\u00e9rica cont\u00ednua que ajuda a caracterizar o estilo de jogo do mandante, podendo variar bastante entre equipes mais ou menos dependentes da posse de bola.  Na an\u00e1lise explorat\u00f3ria, observar a distribui\u00e7\u00e3o dos passes permite identificar m\u00e9dias, dispers\u00e3o e valores at\u00edpicos.</p> 2025-12-09T12:44:41.502276 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_pass</code> indica o n\u00famero de passes realizados pelo time visitante em cada partida.  Sendo uma vari\u00e1vel num\u00e9rica cont\u00ednua, sua distribui\u00e7\u00e3o mostra como os visitantes se comportam em termos de constru\u00e7\u00e3o de jogadas e controle de posse fora de casa.  A an\u00e1lise explorat\u00f3ria ajuda a entender a m\u00e9dia de passes, varia\u00e7\u00f5es entre os jogos e eventuais valores extremos.</p> 2025-12-09T12:44:41.632379 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>home_chances</code> representa a quantidade de chances de gol criadas pelo time mandante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que indica o n\u00edvel de ofensividade da equipe jogando em casa.  A an\u00e1lise explorat\u00f3ria permite identificar a frequ\u00eancia de jogos com poucas ou muitas oportunidades e verificar a dispers\u00e3o desse tipo de estat\u00edstica.</p> 2025-12-09T12:44:41.767215 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/ <p>A coluna <code>away_chances</code> indica a quantidade de chances de gol criadas pelo time visitante durante a partida.  \u00c9 uma vari\u00e1vel num\u00e9rica discreta que ajuda a compreender a ofensividade dos times jogando fora de casa.  A an\u00e1lise explorat\u00f3ria mostra como os visitantes se comportam em termos de cria\u00e7\u00e3o de oportunidades, permitindo identificar padr\u00f5es de equil\u00edbrio ou diferen\u00e7as marcantes em rela\u00e7\u00e3o aos mandantes.</p> 2025-12-09T12:44:41.903431 image/svg+xml Matplotlib v3.10.7, https://matplotlib.org/"},{"location":"random-forest/main/#pre-processamento","title":"Pr\u00e9-processamento","text":"<p>Ap\u00f3s a explora\u00e7\u00e3o inicial da base, foram aplicados procedimentos de pr\u00e9-processamento para preparar os dados para o treinamento do modelo. Entre as etapas realizadas est\u00e3o:</p> <ul> <li>Convers\u00e3o de tipos: vari\u00e1veis originalmente em texto com valores num\u00e9ricos (como <code>attendance</code>) foram transformadas em formato num\u00e9rico.  </li> <li>Tratamento de valores categ\u00f3ricos: colunas como <code>stadium</code>, <code>Home Team</code> e <code>Away Team</code> foram mantidas como categ\u00f3ricas, sendo posteriormente convertidas em vari\u00e1veis num\u00e9ricas por meio de t\u00e9cnicas de codifica\u00e7\u00e3o.  </li> <li>Remo\u00e7\u00e3o de colunas irrelevantes ou redundantes: colunas de identifica\u00e7\u00e3o e de tempo (<code>date</code>, <code>clock</code>, <code>links</code>), bem como estat\u00edsticas que representam vazamento de informa\u00e7\u00e3o do resultado (ex.: <code>Goals Home</code>, <code>Away Goals</code>), foram descartadas do conjunto de treino.  </li> <li>Separa\u00e7\u00e3o entre features e target: as vari\u00e1veis explicativas (<code>X</code>) foram definidas a partir de aproximadamente dez colunas relevantes da base, enquanto a vari\u00e1vel alvo (<code>y</code>) \u00e9 a coluna <code>class</code>.  </li> <li>Divis\u00e3o em treino e teste: o conjunto de dados foi dividido em duas partes, garantindo estratifica\u00e7\u00e3o do alvo para manter o equil\u00edbrio das classes.</li> </ul> Base preparadacodeBase original stadium class attendance Home Team Away Team home_possessions away_possessions home_pass away_pass home_chances away_chances 8 0 0 1 20 58.3 41.7 91.1 83.4 2 0 7 0 59653 2 20 61.3 38.7 79.9 74.1 3 0 12 0 0 13 2 54.6 45.4 91 89.1 1 1 2 1 53306 5 7 66.3 33.7 84.3 66.7 1 2 12 1 31219 13 22 64 36 89.1 76.6 1 3 6 2 36447 19 10 57.2 42.8 79.9 71.8 3 5 1 0 31604 6 14 49.9 50.1 82.4 81.5 1 0 1 1 31166 6 19 56.5 43.5 78 70.2 2 1 6 1 0 19 12 37.7 62.3 73 83.7 0 0 17 1 39933 12 17 80.1 19.9 89.8 55.7 5 1 8 2 52786 1 9 74.6 25.4 85.2 56.9 1 5 <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\nprint(df.sample(frac=.01).to_markdown(index=False))\n</code></pre> date clock stadium class attendance Home Team Goals Home Away Team Away Goals home_possessions away_possessions home_shots away_shots home_on away_on home_off away_off home_blocked away_blocked home_pass away_pass home_chances away_chances home_corners away_corners home_offside away_offside home_tackles away_tackles home_duels away_duels home_saves away_saves home_fouls away_fouls home_yellow away_yellow home_red away_red links 8th April 2022 8:00pm St James' Park, Newcastle h 52,164 4 1 13 0 41.1 58.9 12 5 4 2 3 2 5 1 81.5 83 0 0 1 2 1 0 63.6 50 52.4 47.6 2 3 6 13 1 1 0 0 https://www.skysports.com/football/newcastle-united-vs-wolverhampton-wanderers/stats/446604 8/2/2021 8:00pm Elland Road h 0 19 2 11 0 68.2 31.8 17 8 7 3 7 2 3 3 87.4 76.8 2 0 5 3 1 1 45.5 45.5 51.9 48.1 3 5 7 8 0 2 0 0 https://www.skysports.com/football/leeds-united-vs-crystal-palace/stats/429060 5th February 2023 4:30pm Tottenham Hotspur Stadium h 61,747 8 1 1 0 35.2 64.8 12 15 3 5 5 5 4 5 74.6 87.6 2 0 4 6 2 1 57.1 47.4 36 64 5 2 19 14 2 3 1 0 https://www.skysports.com/football/tottenham-hotspur-vs-manchester-city/464853 4th January 2023 7:45pm Elland Road d 36,173 19 2 14 2 63.3 36.7 14 15 6 2 6 11 2 2 79.4 62.5 1 0 8 1 3 3 68.4 47.4 47.9 52.1 0 3 11 18 3 1 0 0 https://www.skysports.com/football/leeds-united-vs-west-ham-united/464821 10th April 2022 4:30pm Etihad Stadium d 53,197 1 2 5 2 55.1 44.9 11 6 5 4 4 2 2 0 85.9 80.6 2 3 4 1 5 2 35.3 66.7 50 50 2 2 9 11 1 4 0 0 https://www.skysports.com/football/manchester-city-vs-liverpool/stats/446603 30/01/2021 5:30pm Emirates Stadium d 0 2 0 3 0 43.3 56.7 17 14 3 3 8 8 6 3 80.7 85.9 0 2 4 7 0 2 53.8 40 45.5 54.5 3 3 9 10 1 3 0 0 https://www.skysports.com/football/arsenal-vs-manchester-united/stats/429037 21st August 2021 3:00pm Etihad Stadium h 51,437 1 5 22 0 66.9 33.1 16 1 4 0 6 1 6 0 93.7 84.8 3 0 6 1 2 3 57.1 61.1 75 25 0 0 13 7 1 0 0 0 https://www.skysports.com/football/manchester-city-vs-norwich-city/stats/446304 25th April 2023 7:45pm Villa Park h 41,046 7 1 10 0 51.8 48.2 14 1 3 0 4 1 7 0 83.7 81.3 0 0 8 2 0 5 63.6 38.1 65.2 34.8 0 2 6 18 3 2 0 0 https://www.skysports.com/football/aston-villa-vs-fulham/464955 4th January 2023 8:00pm Villa Park d 39,978 7 1 13 1 55.9 44.1 13 10 4 3 3 4 6 3 87.6 83.8 2 0 7 8 1 4 45.5 58.6 40.9 59.1 2 2 6 12 1 3 0 0 https://www.skysports.com/football/aston-villa-vs-wolverhampton-wanderers/464816 4th February 2023 3:00pm Villa Park a 42,055 7 2 18 4 63.2 36.8 19 9 4 5 6 4 9 0 86.7 74.8 0 4 11 3 2 8 66.7 69.6 54.5 45.5 1 3 10 10 0 3 0 0 https://www.skysports.com/football/aston-villa-vs-leicester-city/464845 27th April 2023 7:45pm Goodison Park h 39,248 17 1 4 4 39.6 60.4 13 15 5 8 5 3 3 4 65.3 74.8 0 1 3 14 3 1 50 50 55 45 3 4 8 6 2 1 0 0 https://www.skysports.com/football/everton-vs-newcastle-united/464956"},{"location":"random-forest/main/#divisao-dos-dados","title":"Divis\u00e3o dos Dados","text":"<p>Com a base pr\u00e9-processada, realizou-se a divis\u00e3o entre conjuntos de treinamento e teste. O objetivo dessa etapa \u00e9 garantir que o modelo seja avaliado em dados que ele nunca viu durante o treinamento, permitindo uma medida mais confi\u00e1vel de sua capacidade de generaliza\u00e7\u00e3o.  </p> <p>Foi utilizada a fun\u00e7\u00e3o <code>train_test_split</code> da biblioteca scikit-learn, com os seguintes crit\u00e9rios: - 70% dos dados destinados ao treinamento, para que o modelo aprenda os padr\u00f5es da base; - 30% dos dados destinados ao teste, para avaliar o desempenho em novos exemplos; - Estratifica\u00e7\u00e3o pelo alvo (<code>class</code>), garantindo que a propor\u00e7\u00e3o entre vit\u00f3rias do mandante, empates e vit\u00f3rias do visitante fosse mantida em ambos os conjuntos; - Random State fixado, assegurando reprodutibilidade na divis\u00e3o.  </p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nfrom io import StringIO\nfrom sklearn.preprocessing import LabelEncoder\n\nlabel_encoder = LabelEncoder()\n\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# Excluir as colunas n\u00e3o desejadas\ndf = df.drop(columns= [\"date\", \"clock\", \"links\", \"Goals Home\", \"Away Goals\", \"home_shots\", \"away_shots\", \"home_on\", \"away_on\",\n                        \"home_off\", \"away_off\", \"home_blocked\", \"away_blocked\", \"home_corners\", \"away_corners\", \n                        \"home_offside\", \"away_offside\", \"home_tackles\", \"away_tackles\", \"home_duels\", \"away_duels\",\n                        \"home_saves\", \"away_saves\", \"home_fouls\", \"away_fouls\", \"home_yellow\", \"away_yellow\",\n                        \"home_red\", \"away_red\"])\n\n# Label encoding dos estadios em texto\ndf[\"stadium\"] = label_encoder.fit_transform(df[\"stadium\"])\n\n# Transformar resultado do jogo times em n\u00fameros\ndf[\"class\"] = df[\"class\"].replace({'h':0, 'd': 1, 'a':2})\n\n# Transforma o p\u00fablido de string para n\u00famero\ndf[\"attendance\"] = df[\"attendance\"].str.replace(',', '').astype(int)\n\n# Vari\u00e1veis independentes (features)\nx = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]]\n\n# Vari\u00e1vel dependente (alvo)\ny = df[\"class\"]\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=27, stratify=y)\n</code></pre>"},{"location":"random-forest/main/#treinamento-do-modelo","title":"Treinamento do Modelo","text":"<p>O conjunto de treino (70%) foi usado para ajustar a floresta; o teste (30%) permaneceu isolado para avalia\u00e7\u00e3o justa.</p> ModeloC\u00f3digo <p>Accuracy: 0.5673 Import\u00e2ncia das Features:  Feature Import\u00e2ncia away_chances 0.221561 home_chances 0.116014 Home Team 0.111948 Away Team 0.109174 away_pass 0.103906 home_pass 0.100182 attendance 0.086747 away_possessions 0.055630 home_possessions 0.051652 stadium 0.043184 </p> <pre><code>import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import LabelEncoder\nimport numpy as np\n\n# ===================== Ler base =====================\ndf = pd.read_csv(\"./src/mydata.csv\")\n\n# ===================== Excluir colunas de vazamento/irrelevantes =====================\ndf = df.drop(columns=[\n    \"date\", \"clock\", \"links\",\n    \"Goals Home\", \"Away Goals\",\n    \"home_shots\", \"away_shots\",\n    \"home_on\", \"away_on\",\n    \"home_off\", \"away_off\",\n    \"home_blocked\", \"away_blocked\",\n    \"home_corners\", \"away_corners\",\n    \"home_offside\", \"away_offside\",\n    \"home_tackles\", \"away_tackles\",\n    \"home_duels\", \"away_duels\",\n    \"home_saves\", \"away_saves\",\n    \"home_fouls\", \"away_fouls\",\n    \"home_yellow\", \"away_yellow\",\n    \"home_red\", \"away_red\"\n], errors=\"ignore\")\n\n# ===================== Limpezas =====================\n# stadium em texto -&gt; label encoding\nle_stadium = LabelEncoder()\ndf[\"stadium\"] = le_stadium.fit_transform(df[\"stadium\"].astype(str))\n\n# class: h/d/a -&gt; 0/1/2\ndf[\"class\"] = df[\"class\"].replace({\"h\": 0, \"d\": 1, \"a\": 2}).astype(int)\n\n# attendance: \"12,345\" -&gt; 12345\ndf[\"attendance\"] = (\n    df[\"attendance\"]\n      .astype(str)\n      .str.replace(r\"[^0-9]\", \"\", regex=True)\n      .replace(\"\", \"0\")\n      .astype(float)\n)\n\n# garantir num\u00e9ricos + imputar medianas nas features\nnum_cols = [\n    \"attendance\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]\nfor c in num_cols:\n    df[c] = pd.to_numeric(df[c], errors=\"coerce\")\n    med = df[c].median() if df[c].notna().any() else 0\n    df[c] = df[c].fillna(med)\n\n# ===================== Features e alvo =====================\nX = df[[\n    \"stadium\", \"attendance\",\n    \"Home Team\", \"Away Team\",\n    \"home_possessions\", \"away_possessions\",\n    \"home_pass\", \"away_pass\",\n    \"home_chances\", \"away_chances\"\n]].copy()\n\ny = df[\"class\"].copy()\n\n# Alguns times podem ter NA; garantir num\u00e9rico\nX[\"Home Team\"] = pd.to_numeric(X[\"Home Team\"], errors=\"coerce\").fillna(-1).astype(int)\nX[\"Away Team\"] = pd.to_numeric(X[\"Away Team\"], errors=\"coerce\").fillna(-1).astype(int)\n\n# ===================== Split (70/30) com estratifica\u00e7\u00e3o =====================\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.30, random_state=27, stratify=y\n)\n\n# ===================== Random Forest =====================\nrf = RandomForestClassifier(\n    n_estimators=100,      # n\u00famero de \u00e1rvores\n    max_depth=5,          # profundidade m\u00e1xima (controle de overfitting)\n    max_features='sqrt',  # n\u00ba de features por split\n    random_state=27,\n    n_jobs=-1\n)\nrf.fit(X_train, y_train)\n\n# ===================== Avalia\u00e7\u00e3o =====================\npred = rf.predict(X_test)\nacc = accuracy_score(y_test, pred)\nprint(f\"Accuracy: {acc:.4f}\")\n\n# Import\u00e2ncia das features\nfeat_imp = pd.DataFrame({\n    \"Feature\": rf.feature_names_in_,\n    \"Import\u00e2ncia\": rf.feature_importances_\n}).sort_values(\"Import\u00e2ncia\", ascending=False)\n\nprint(\"&lt;br&gt;Import\u00e2ncia das Features:\")\nprint(feat_imp.to_html(index=False))\n</code></pre>"},{"location":"random-forest/main/#avaliacao-do-modelo","title":"Avalia\u00e7\u00e3o do Modelo","text":"<p>Acur\u00e1cia (teste): 0.5673.   Esse desempenho supera os resultados anteriores (\u00c1rvore \u2248 0,48; KNN \u2248 0,42\u20130,51), indicando melhor generaliza\u00e7\u00e3o e robustez da Random Forest no problema.</p> <ul> <li>Import\u00e2ncia das vari\u00e1veis (top-10):</li> <li><code>away_chances</code> \u2014 0.2216  </li> <li><code>home_chances</code> \u2014 0.1160  </li> <li><code>Home Team</code> \u2014 0.1119  </li> <li><code>Away Team</code> \u2014 0.1092  </li> <li><code>away_pass</code> \u2014 0.1039  </li> <li><code>home_pass</code> \u2014 0.1002  </li> <li><code>attendance</code> \u2014 0.0867  </li> <li><code>away_possessions</code> \u2014 0.0556  </li> <li><code>home_possessions</code> \u2014 0.0517  </li> <li><code>stadium</code> \u2014 0.0432</li> </ul> <p>Leituras r\u00e1pidas: - Chances criadas (mandante/visitante) e passes s\u00e3o os sinais mais relevantes \u2014 coerente com din\u00e2mica ofensiva/controle de jogo. - Os IDs dos times entram forte (efeitos fixos de qualidade/estilo). - Est\u00e1dio pesa menos, sugerindo que, ap\u00f3s controlar por equipe e m\u00e9tricas do jogo, o local adiciona pouca informa\u00e7\u00e3o.</p>"},{"location":"random-forest/main/#relatorio-final","title":"Relat\u00f3rio Final","text":"<p>A Random Forest apresentou melhor desempenho que a \u00c1rvore de Decis\u00e3o e o KNN, indicando ganho com agrega\u00e7\u00e3o de m\u00faltiplas \u00e1rvores e menor vari\u00e2ncia. Ainda assim, prever resultados de futebol segue dif\u00edcil (classe de empate \u00e9 rara e ruidosa), o que limita a acur\u00e1cia.</p> <p>Resultado geral: a RF \u00e9 a melhor baseline at\u00e9 aqui para este conjunto de vari\u00e1veis, com boa interpretabilidade via import\u00e2ncias e espa\u00e7o claro para melhoria com feature engineering e ajuste fino.</p>"}]}